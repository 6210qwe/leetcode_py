# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2858
标题: Join Two Arrays by ID
难度: medium
链接: https://leetcode.cn/problems/join-two-arrays-by-id/
题目类型: 其他
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2722. 根据 ID 合并两个数组 - 现给定两个数组 arr1 和 arr2 ，返回一个新的数组 joinedArray 。两个输入数组中的每个对象都包含一个 id 字段。 joinedArray 是一个通过 id 将 arr1 和 arr2 连接而成的数组。joinedArray 的长度应为唯一值 id 的长度。返回的数组应按 id 升序 排序。 如果一个 id 存在于一个数组中但不存在于另一个数组中，则该对象应包含在结果数组中且不进行修改。 如果两个对象共享一个 id ，则它们的属性应进行合并： * 如果一个键只存在于一个对象中，则该键值对应该包含在对象中。 * 如果一个键在两个对象中都包含，则 arr2 中的值应覆盖 arr1 中的值。 示例 1： 输入： arr1 = [ {"id": 1, "x": 1}, {"id": 2, "x": 9} ], arr2 = [ {"id": 3, "x": 5} ] 输出： [ {"id": 1, "x": 1}, {"id": 2, "x": 9}, {"id": 3, "x": 5} ] 解释：没有共同的 id，因此将 arr1 与 arr2 简单地连接起来。 示例 2： 输入： arr1 = [ {"id": 1, "x": 2, "y": 3}, {"id": 2, "x": 3, "y": 6} ], arr2 = [ {"id": 2, "x": 10, "y": 20}, {"id": 3, "x": 0, "y": 0} ] 输出： [ {"id": 1, "x": 2, "y": 3}, {"id": 2, "x": 10, "y": 20}, {"id": 3, "x": 0, "y": 0} ] 解释：id 为 1 和 id 为 3 的对象在结果数组中保持不变。id 为 2 的两个对象合并在一起。arr2 中的键覆盖 arr1 中的值。 示例 3： 输入： arr1 = [ {"id": 1, "b": {"b": 94},"v": [4, 3], "y": 48} ] arr2 = [ {"id": 1, "b": {"c": 84}, "v": [1, 3]} ] 输出： [ {"id": 1, "b": {"c": 84}, "v": [1, 3], "y": 48} ] 解释：具有 id 为 1 的对象合并在一起。对于键 "b" 和 "v" ，使用 arr2 中的值。由于键 "y" 只存在于 arr1 中，因此取 arr1 的值。 提示： * arr1 和 arr2 都是有效的 JSON 数组 * 在 arr1 和 arr2 中都有唯一的键值 id * 2 <= JSON.stringify(arr1).length <= 106 * 2 <= JSON.stringify(arr2).length <= 106
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用哈希表来存储和合并对象，并按 id 排序。

算法步骤:
1. 创建一个字典来存储所有对象，键为 id。
2. 遍历 arr1 和 arr2，将对象添加到字典中，如果 id 已存在则合并对象。
3. 按 id 对字典中的对象进行排序。
4. 返回排序后的对象列表。

关键点:
- 使用字典来存储和合并对象，确保时间复杂度最优。
- 最后按 id 排序以满足题目要求。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log n)，其中 n 是 arr1 和 arr2 的总长度。主要的时间开销在排序上。
空间复杂度: O(n)，需要额外的空间来存储合并后的对象。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def join_two_arrays_by_id(arr1: List[dict], arr2: List[dict]) -> List[dict]:
    """
    根据 ID 合并两个数组
    """
    # 创建一个字典来存储所有对象
    id_to_obj = {}
    
    # 将 arr1 中的对象添加到字典中
    for obj in arr1:
        id_to_obj[obj["id"]] = obj
    
    # 将 arr2 中的对象添加到字典中，如果 id 已存在则合并对象
    for obj in arr2:
        if obj["id"] in id_to_obj:
            id_to_obj[obj["id"]].update(obj)
        else:
            id_to_obj[obj["id"]] = obj
    
    # 按 id 对字典中的对象进行排序
    sorted_objs = sorted(id_to_obj.values(), key=lambda x: x["id"])
    
    return sorted_objs

Solution = create_solution(join_two_arrays_by_id)