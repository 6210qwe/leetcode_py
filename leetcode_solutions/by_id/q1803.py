# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1803
标题: Average Waiting Time
难度: medium
链接: https://leetcode.cn/problems/average-waiting-time/
题目类型: 数组、模拟
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1701. 平均等待时间 - 有一个餐厅，只有一位厨师。你有一个顾客数组 customers ，其中 customers[i] = [arrivali, timei] ： * arrivali 是第 i 位顾客到达的时间，到达时间按 非递减 顺序排列。 * timei 是给第 i 位顾客做菜需要的时间。 当一位顾客到达时，他将他的订单给厨师，厨师一旦空闲的时候就开始做这位顾客的菜。每位顾客会一直等待到厨师完成他的订单。厨师同时只能做一个人的订单。厨师会严格按照 订单给他的顺序 做菜。 请你返回所有顾客需要等待的 平均 时间。与标准答案误差在 10-5 范围以内，都视为正确结果。 示例 1： 输入：customers = [[1,2],[2,5],[4,3]] 输出：5.00000 解释： 1) 第一位顾客在时刻 1 到达，厨师拿到他的订单并在时刻 1 立马开始做菜，并在时刻 3 完成，第一位顾客等待时间为 3 - 1 = 2 。 2) 第二位顾客在时刻 2 到达，厨师在时刻 3 开始为他做菜，并在时刻 8 完成，第二位顾客等待时间为 8 - 2 = 6 。 3) 第三位顾客在时刻 4 到达，厨师在时刻 8 开始为他做菜，并在时刻 11 完成，第三位顾客等待时间为 11 - 4 = 7 。 平均等待时间为 (2 + 6 + 7) / 3 = 5 。 示例 2： 输入：customers = [[5,2],[5,4],[10,3],[20,1]] 输出：3.25000 解释： 1) 第一位顾客在时刻 5 到达，厨师拿到他的订单并在时刻 5 立马开始做菜，并在时刻 7 完成，第一位顾客等待时间为 7 - 5 = 2 。 2) 第二位顾客在时刻 5 到达，厨师在时刻 7 开始为他做菜，并在时刻 11 完成，第二位顾客等待时间为 11 - 5 = 6 。 3) 第三位顾客在时刻 10 到达，厨师在时刻 11 开始为他做菜，并在时刻 14 完成，第三位顾客等待时间为 14 - 10 = 4 。 4) 第四位顾客在时刻 20 到达，厨师拿到他的订单并在时刻 20 立马开始做菜，并在时刻 21 完成，第四位顾客等待时间为 21 - 20 = 1 。 平均等待时间为 (2 + 6 + 4 + 1) / 4 = 3.25 。 提示： * 1 <= customers.length <= 105 * 1 <= arrivali, timei <= 104 * arrivali <= arrivali+1
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 模拟厨师做菜过程，计算每个顾客的等待时间

算法步骤:
1. 维护当前时间
2. 对于每个顾客，计算开始时间和完成时间
3. 累加等待时间

关键点:
- 模拟过程
- 时间计算
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n) - n为顾客数量
空间复杂度: O(1) - 只使用常数额外空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def average_waiting_time(customers: List[List[int]]) -> float:
    """
    函数式接口 - 平均等待时间
    
    实现思路:
    模拟厨师做菜过程，计算每个顾客的等待时间。
    
    Args:
        customers: 顾客数组，每个元素为[到达时间, 做菜时间]
        
    Returns:
        平均等待时间
        
    Example:
        >>> average_waiting_time([[1,2],[2,5],[4,3]])
        5.0
    """
    current_time = 0
    total_waiting = 0
    
    for arrival, time_needed in customers:
        # 厨师开始做菜的时间
        start_time = max(current_time, arrival)
        # 完成时间
        finish_time = start_time + time_needed
        # 等待时间
        waiting_time = finish_time - arrival
        total_waiting += waiting_time
        current_time = finish_time
    
    return total_waiting / len(customers)


Solution = create_solution(average_waiting_time)
