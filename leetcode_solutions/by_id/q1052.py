# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1052
标题: Campus Bikes
难度: medium
链接: https://leetcode.cn/problems/campus-bikes/
题目类型: 数组、排序、堆（优先队列）
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1057. 校园自行车分配 - 备战技术面试？力扣提供海量技术面试资源，帮助你高效提升编程技能,轻松拿下世界 IT 名企 Dream Offer。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用曼哈顿距离计算每个工人到每辆自行车的距离，并将这些距离存储在一个列表中。然后对这个列表进行排序，优先选择最短距离的配对。

算法步骤:
1. 计算每个工人到每辆自行车的曼哈顿距离，并将这些距离存储在一个列表中，同时记录对应的工人和自行车索引。
2. 对这个列表按距离进行排序。
3. 使用一个集合来记录已经被分配的自行车，遍历排序后的列表，为每个工人分配最近且未被分配的自行车。

关键点:
- 使用曼哈顿距离计算距离。
- 使用优先队列（或排序）来确保每次分配都是最优的。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(nm log(nm))，其中 n 是工人的数量，m 是自行车的数量。需要计算 n * m 个距离，并对它们进行排序。
空间复杂度: O(nm)，用于存储所有距离及其对应的工人和自行车索引。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def assignBikes(workers: List[List[int]], bikes: List[List[int]]) -> List[int]:
    """
    函数式接口 - 实现校园自行车分配
    """
    # 计算每个工人到每辆自行车的曼哈顿距离
    distances = []
    for i, (wx, wy) in enumerate(workers):
        for j, (bx, by) in enumerate(bikes):
            dist = abs(wx - bx) + abs(wy - by)
            distances.append((dist, i, j))
    
    # 按距离排序
    distances.sort()
    
    # 使用集合记录已被分配的自行车
    assigned_bikes = set()
    result = [-1] * len(workers)
    
    # 为每个工人分配最近且未被分配的自行车
    for _, worker, bike in distances:
        if result[worker] == -1 and bike not in assigned_bikes:
            result[worker] = bike
            assigned_bikes.add(bike)
    
    return result

Solution = create_solution(assignBikes)