# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2752
标题: Sum Multiples
难度: easy
链接: https://leetcode.cn/problems/sum-multiples/
题目类型: 数学
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2652. 倍数求和 - 给你一个正整数 n ，请你计算在 [1，n] 范围内能被 3、5、7 整除的所有整数之和。 返回一个整数，用于表示给定范围内所有满足约束条件的数字之和。 示例 1： 输入：n = 7 输出：21 解释：在 [1, 7] 范围内能被 3、5、7 整除的所有整数分别是 3、5、6、7 。数字之和为 21。 示例 2： 输入：n = 10 输出：40 解释：在 [1, 10] 范围内能被 3、5、7 整除的所有整数分别是 3、5、6、7、9、10 。数字之和为 40。 示例 3： 输入：n = 9 输出：30 解释：在 [1, 9] 范围内能被 3、5、7 整除的所有整数分别是 3、5、6、7、9 。数字之和为 30。 提示： * 1 <= n <= 103
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用容斥原理来计算能被 3、5、7 整除的所有整数之和。

算法步骤:
1. 计算能被 3、5、7 整除的整数之和。
2. 使用容斥原理减去重复计算的部分（即同时能被两个或三个数整除的部分）。

关键点:
- 使用等差数列求和公式来计算每个部分的和。
- 容斥原理确保不重复计算。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(1)
空间复杂度: O(1)
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def sum_of_multiples(n: int) -> int:
    """
    函数式接口 - 计算在 [1, n] 范围内能被 3、5、7 整除的所有整数之和。
    """
    def sum_divisible_by(k: int) -> int:
        """计算从 1 到 n 中能被 k 整除的数的和"""
        p = n // k
        return k * p * (p + 1) // 2

    # 计算能被 3、5、7 整除的数的和
    sum_3 = sum_divisible_by(3)
    sum_5 = sum_divisible_by(5)
    sum_7 = sum_divisible_by(7)

    # 计算能被 15、21、35 整除的数的和
    sum_15 = sum_divisible_by(15)
    sum_21 = sum_divisible_by(21)
    sum_35 = sum_divisible_by(35)

    # 计算能被 105 整除的数的和
    sum_105 = sum_divisible_by(105)

    # 使用容斥原理计算最终结果
    return sum_3 + sum_5 + sum_7 - sum_15 - sum_21 - sum_35 + sum_105


Solution = create_solution(sum_of_multiples)