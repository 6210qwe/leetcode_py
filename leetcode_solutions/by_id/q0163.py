# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 163
标题: Missing Ranges
难度: easy
链接: https://leetcode.cn/problems/missing-ranges/
题目类型: 数组
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
163. 缺失的区间 - 备战技术面试？力扣提供海量技术面试资源，帮助你高效提升编程技能,轻松拿下世界 IT 名企 Dream Offer。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 遍历数组，找出缺失的区间范围

算法步骤:
1. 从lower开始，检查到第一个元素之间的区间
2. 遍历数组，检查相邻元素之间的区间
3. 检查最后一个元素到upper之间的区间
4. 格式化区间为字符串

关键点:
- 处理边界情况和区间格式化
- 时间复杂度O(n)，空间复杂度O(1)
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n) - 需要遍历数组一次
空间复杂度: O(1) - 只使用常数额外空间（不包括结果数组）
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List
from leetcode_solutions.utils.solution import create_solution


def missing_ranges(nums: List[int], lower: int, upper: int) -> List[str]:
    """
    函数式接口 - 找出缺失的区间
    
    实现思路:
    遍历数组，找出缺失的区间范围。
    
    Args:
        nums: 已排序的整数数组
        lower: 下界
        upper: 上界
        
    Returns:
        缺失区间列表，格式为["a->b"]或["a"]
        
    Example:
        >>> missing_ranges([0, 1, 3, 50, 75], 0, 99)
        ['2', '4->49', '51->74', '76->99']
    """
    result = []
    
    def add_range(start: int, end: int):
        """添加区间到结果"""
        if start > end:
            return
        if start == end:
            result.append(str(start))
        else:
            result.append(f"{start}->{end}")
    
    # 检查lower到第一个元素
    if not nums or nums[0] > lower:
        add_range(lower, nums[0] - 1 if nums else upper)
    
    # 检查数组中间的元素
    for i in range(len(nums) - 1):
        if nums[i + 1] - nums[i] > 1:
            add_range(nums[i] + 1, nums[i + 1] - 1)
    
    # 检查最后一个元素到upper
    if nums and nums[-1] < upper:
        add_range(nums[-1] + 1, upper)
    
    return result


# 自动生成Solution类（无需手动编写）
Solution = create_solution(missing_ranges)
