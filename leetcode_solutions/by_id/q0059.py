# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 59
标题: Spiral Matrix II
难度: medium
链接: https://leetcode.cn/problems/spiral-matrix-ii/
题目类型: 数组、矩阵、模拟
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
59. 螺旋矩阵 II - 给你一个正整数 n ，生成一个包含 1 到 n2 所有元素，且元素按顺时针顺序螺旋排列的 n x n 正方形矩阵 matrix 。 示例 1： [https://assets.leetcode.com/uploads/2020/11/13/spiraln.jpg] 输入：n = 3 输出：[[1,2,3],[8,9,4],[7,6,5]] 示例 2： 输入：n = 1 输出：[[1]] 提示： * 1 <= n <= 20
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 模拟螺旋填充，使用四个边界变量控制填充方向

算法步骤:
1. 创建n×n的矩阵，初始化为0
2. 初始化四个边界和计数器num=1
3. 按照右->下->左->上的顺序填充：
   - 向右：从left到right，填充top行
   - 向下：从top到bottom，填充right列
   - 向左：从right到left，填充bottom行
   - 向上：从bottom到top，填充left列
4. 每次填充完一行或一列后，更新边界和计数器
5. 重复直到填充完所有n²个元素

关键点:
- 与54题类似，但这里是填充而不是读取
- 使用边界变量控制填充范围
- 注意边界条件，避免重复填充
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n²) - 需要填充n²个元素
空间复杂度: O(n²) - 存储结果矩阵
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List
from leetcode_solutions.utils.solution import create_solution


def generate_matrix(n: int) -> List[List[int]]:
    """
    函数式接口 - 模拟螺旋填充
    
    实现思路:
    使用四个边界变量控制填充方向，按照右->下->左->上的顺序填充矩阵。
    
    Args:
        n: 矩阵大小（n×n）
        
    Returns:
        包含1到n²所有元素，按顺时针顺序螺旋排列的n×n矩阵
        
    Example:
        >>> generate_matrix(3)
        [[1, 2, 3], [8, 9, 4], [7, 6, 5]]
    """
    matrix = [[0] * n for _ in range(n)]
    top, bottom, left, right = 0, n - 1, 0, n - 1
    num = 1
    
    while top <= bottom and left <= right:
        # 向右
        for j in range(left, right + 1):
            matrix[top][j] = num
            num += 1
        top += 1
        
        # 向下
        for i in range(top, bottom + 1):
            matrix[i][right] = num
            num += 1
        right -= 1
        
        # 向左
        if top <= bottom:
            for j in range(right, left - 1, -1):
                matrix[bottom][j] = num
                num += 1
            bottom -= 1
        
        # 向上
        if left <= right:
            for i in range(bottom, top - 1, -1):
                matrix[i][left] = num
                num += 1
            left += 1
    
    return matrix


# 自动生成Solution类（无需手动编写）
Solution = create_solution(generate_matrix)
