# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2691
标题: Count Vowel Strings in Ranges
难度: medium
链接: https://leetcode.cn/problems/count-vowel-strings-in-ranges/
题目类型: 数组、字符串、前缀和
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2559. 统计范围内的元音字符串数 - 给你一个下标从 0 开始的字符串数组 words 以及一个二维整数数组 queries 。 每个查询 queries[i] = [li, ri] 会要求我们统计在 words 中下标在 li 到 ri 范围内（包含 这两个值）并且以元音开头和结尾的字符串的数目。 返回一个整数数组，其中数组的第 i 个元素对应第 i 个查询的答案。 注意：元音字母是 'a'、'e'、'i'、'o' 和 'u' 。 示例 1： 输入：words = ["aba","bcb","ece","aa","e"], queries = [[0,2],[1,4],[1,1]] 输出：[2,3,0] 解释：以元音开头和结尾的字符串是 "aba"、"ece"、"aa" 和 "e" 。 查询 [0,2] 结果为 2（字符串 "aba" 和 "ece"）。 查询 [1,4] 结果为 3（字符串 "ece"、"aa"、"e"）。 查询 [1,1] 结果为 0 。 返回结果 [2,3,0] 。 示例 2： 输入：words = ["a","e","i"], queries = [[0,2],[0,1],[2,2]] 输出：[3,2,1] 解释：每个字符串都满足这一条件，所以返回 [3,2,1] 。 提示： * 1 <= words.length <= 105 * 1 <= words[i].length <= 40 * words[i] 仅由小写英文字母组成 * sum(words[i].length) <= 3 * 105 * 1 <= queries.length <= 105 * 0 <= queries[j][0] <= queries[j][1] < words.length
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用前缀和来快速计算区间内的元音字符串数量。

算法步骤:
1. 遍历 `words` 数组，生成一个前缀和数组 `prefix_sum`，其中 `prefix_sum[i]` 表示从 `words[0]` 到 `words[i-1]` 中以元音开头和结尾的字符串数量。
2. 对于每个查询 `[li, ri]`，使用前缀和数组快速计算区间 `[li, ri]` 内的元音字符串数量。

关键点:
- 使用前缀和数组可以将每次查询的时间复杂度从 O(n) 降低到 O(1)。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n + m)，其中 n 是 `words` 的长度，m 是 `queries` 的长度。
空间复杂度: O(n)，用于存储前缀和数组。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def is_vowel_string(word: str) -> bool:
    vowels = {'a', 'e', 'i', 'o', 'u'}
    return word[0] in vowels and word[-1] in vowels

def vowel_strings_in_ranges(words: List[str], queries: List[List[int]]) -> List[int]:
    n = len(words)
    prefix_sum = [0] * (n + 1)
    
    for i in range(n):
        prefix_sum[i + 1] = prefix_sum[i] + (1 if is_vowel_string(words[i]) else 0)
    
    result = []
    for li, ri in queries:
        result.append(prefix_sum[ri + 1] - prefix_sum[li])
    
    return result

Solution = create_solution(vowel_strings_in_ranges)