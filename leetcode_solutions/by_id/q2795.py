# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2795
标题: Deep Merge of Two Objects
难度: medium
链接: https://leetcode.cn/problems/deep-merge-of-two-objects/
题目类型: 其他
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2755. 深度合并两个对象 - 备战技术面试？力扣提供海量技术面试资源，帮助你高效提升编程技能,轻松拿下世界 IT 名企 Dream Offer。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用递归方法深度合并两个字典。

算法步骤:
1. 如果任一输入为空，则返回另一个输入。
2. 对于每个键，如果两个字典中都存在该键且对应的值都是字典，则递归合并这两个子字典。
3. 如果两个字典中都存在该键但其中一个值不是字典，则保留第一个字典的值。
4. 如果某个键只存在于一个字典中，则直接将该键值对添加到结果字典中。

关键点:
- 递归地处理嵌套字典。
- 确保在合并过程中不丢失任何键值对。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n + m)，其中 n 和 m 分别是两个输入字典的大小。每个键值对最多只会被访问一次。
空间复杂度: O(n + m)，递归调用栈的深度取决于输入字典的最大嵌套深度。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import Dict, Any


def deep_merge(obj1: Dict[str, Any], obj2: Dict[str, Any]) -> Dict[str, Any]:
    """
    深度合并两个字典。
    :param obj1: 第一个字典
    :param obj2: 第二个字典
    :return: 合并后的字典
    """
    if not obj1:
        return obj2
    if not obj2:
        return obj1

    merged = {}

    for key in set(obj1.keys()).union(obj2.keys()):
        if key in obj1 and key in obj2:
            if isinstance(obj1[key], dict) and isinstance(obj2[key], dict):
                merged[key] = deep_merge(obj1[key], obj2[key])
            else:
                merged[key] = obj1[key]
        elif key in obj1:
            merged[key] = obj1[key]
        else:
            merged[key] = obj2[key]

    return merged


Solution = deep_merge