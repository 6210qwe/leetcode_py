# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2352
标题: Design an ATM Machine
难度: medium
链接: https://leetcode.cn/problems/design-an-atm-machine/
题目类型: 贪心、设计、数组
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2241. 设计一个 ATM 机器 - 一个 ATM 机器，存有 5 种面值的钞票：20 ，50 ，100 ，200 和 500 美元。初始时，ATM 机是空的。用户可以用它存或者取任意数目的钱。 取款时，机器会优先取 较大 数额的钱。 * 比方说，你想取 $300 ，并且机器里有 2 张 $50 的钞票，1 张 $100 的钞票和1 张 $200 的钞票，那么机器会取出 $100 和 $200 的钞票。 * 但是，如果你想取 $600 ，机器里有 3 张 $200 的钞票和1 张 $500 的钞票，那么取款请求会被拒绝，因为机器会先取出 $500 的钞票，然后无法取出剩余的 $100 。注意，因为有 $500 钞票的存在，机器 不能 取 $200 的钞票。 请你实现 ATM 类： * ATM() 初始化 ATM 对象。 * void deposit(int[] banknotesCount) 分别存入 $20 ，$50，$100，$200 和 $500 钞票的数目。 * int[] withdraw(int amount) 返回一个长度为 5 的数组，分别表示 $20 ，$50，$100 ，$200 和 $500 钞票的数目，并且更新 ATM 机里取款后钞票的剩余数量。如果无法取出指定数额的钱，请返回 [-1] （这种情况下 不 取出任何钞票）。 示例 1： 输入： ["ATM", "deposit", "withdraw", "deposit", "withdraw", "withdraw"] [[], [[0,0,1,2,1]], [600], [[0,1,0,1,1]], [600], [550]] 输出： [null, null, [0,0,1,0,1], null, [-1], [0,1,0,0,1]] 解释： ATM atm = new ATM(); atm.deposit([0,0,1,2,1]); // 存入 1 张 $100 ，2 张 $200 和 1 张 $500 的钞票。 atm.withdraw(600); // 返回 [0,0,1,0,1] 。机器返回 1 张 $100 和 1 张 $500 的钞票。机器里剩余钞票的数量为 [0,0,0,2,0] 。 atm.deposit([0,1,0,1,1]); // 存入 1 张 $50 ，1 张 $200 和 1 张 $500 的钞票。 // 机器中剩余钞票数量为 [0,1,0,3,1] 。 atm.withdraw(600); // 返回 [-1] 。机器会尝试取出 $500 的钞票，然后无法得到剩余的 $100 ，所以取款请求会被拒绝。 // 由于请求被拒绝，机器中钞票的数量不会发生改变。 atm.withdraw(550); // 返回 [0,1,0,0,1] ，机器会返回 1 张 $50 的钞票和 1 张 $500 的钞票。 提示： * banknotesCount.length == 5 * 0 <= banknotesCount[i] <= 109 * 1 <= amount <= 109 * 总共 最多有 5000 次 withdraw 和 deposit 的调用。 * 函数 withdraw 和 deposit 至少各有 一次 调用。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用贪心算法，优先使用大面值钞票进行取款。

算法步骤:
1. 初始化 ATM 对象时，创建一个列表来存储每种面值钞票的数量。
2. 在 deposit 方法中，将存入的钞票数量加到相应的面值上。
3. 在 withdraw 方法中，从大面值到小面值依次尝试取出钞票，直到取完所需金额或无法继续取款。
4. 如果成功取出所需金额，更新 ATM 中的钞票数量并返回取出的钞票数量；否则返回 [-1]。

关键点:
- 优先使用大面值钞票进行取款。
- 在取款过程中，如果无法满足剩余金额的需求，则回滚已取出的钞票。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(1) - 取款和存款操作的时间复杂度都是常数级。
空间复杂度: O(1) - 使用固定大小的数组存储钞票数量。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional


class ATM:
    def __init__(self):
        self.bills = [20, 50, 100, 200, 500]
        self.counts = [0] * 5

    def deposit(self, banknotes_count: List[int]) -> None:
        for i in range(5):
            self.counts[i] += banknotes_count[i]

    def withdraw(self, amount: int) -> List[int]:
        result = [0] * 5
        for i in range(4, -1, -1):
            if self.counts[i] > 0:
                bill = self.bills[i]
                count = min(amount // bill, self.counts[i])
                result[i] = count
                amount -= count * bill
        if amount == 0:
            for i in range(5):
                self.counts[i] -= result[i]
            return result
        return [-1]


Solution = create_solution(ATM)