# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 887
标题: Minimum Cost to Hire K Workers
难度: hard
链接: https://leetcode.cn/problems/minimum-cost-to-hire-k-workers/
题目类型: 贪心、数组、排序、堆（优先队列）
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
857. 雇佣 K 名工人的最低成本 - 有 n 名工人。 给定两个数组 quality 和 wage ，其中，quality[i] 表示第 i 名工人的工作质量，其最低期望工资为 wage[i] 。 现在我们想雇佣 k 名工人组成一个 工资组。在雇佣 一组 k 名工人时，我们必须按照下述规则向他们支付工资： 1. 对工资组中的每名工人，应当按其工作质量与同组其他工人的工作质量的比例来支付工资。 2. 工资组中的每名工人至少应当得到他们的最低期望工资。 给定整数 k ，返回 组成满足上述条件的付费群体所需的最小金额 。与实际答案误差相差在 10-5 以内的答案将被接受。 示例 1： 输入： quality = [10,20,5], wage = [70,50,30], k = 2 输出： 105.00000 解释： 我们向 0 号工人支付 70，向 2 号工人支付 35。 示例 2： 输入： quality = [3,1,10,10,1], wage = [4,8,2,2,7], k = 3 输出： 30.66667 解释： 我们向 0 号工人支付 4，向 2 号和 3 号分别支付 13.33333。 提示： * n == quality.length == wage.length * 1 <= k <= n <= 104 * 1 <= quality[i], wage[i] <= 104
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用贪心算法和优先队列（堆）来找到最小成本。

算法步骤:
1. 计算每个工人的工资与质量比 (wage/quality)。
2. 按照工资与质量比从小到大排序。
3. 使用一个最大堆来维护当前选择的 k 个工人的质量总和。
4. 遍历排序后的工人列表，对于每个工人：
   - 将其质量加入堆中，并更新质量总和。
   - 如果堆的大小超过 k，则移除堆中质量最大的工人。
   - 计算当前选择的 k 个工人的总成本，并更新最小成本。

关键点:
- 通过按工资与质量比排序，确保了每次选择的工人都能满足最低工资要求。
- 使用最大堆来维护当前选择的 k 个工人的质量总和，从而可以快速找到最小成本。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log n + n log k)，其中 n 是工人数，k 是要雇佣的工人数。排序的时间复杂度是 O(n log n)，遍历和堆操作的时间复杂度是 O(n log k)。
空间复杂度: O(n + k)，用于存储工人的工资与质量比以及堆。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List
import heapq

def mincostToHireWorkers(quality: List[int], wage: List[int], k: int) -> float:
    """
    函数式接口 - 计算雇佣 k 名工人的最低成本
    """
    # 计算每个工人的工资与质量比
    workers = sorted([(w / q, q) for w, q in zip(wage, quality)])
    
    # 使用最大堆来维护当前选择的 k 个工人的质量总和
    max_heap = []
    total_quality = 0
    min_cost = float('inf')
    
    for ratio, q in workers:
        total_quality += q
        heapq.heappush(max_heap, -q)
        
        if len(max_heap) > k:
            total_quality += heapq.heappop(max_heap)
        
        if len(max_heap) == k:
            min_cost = min(min_cost, total_quality * ratio)
    
    return min_cost

Solution = create_solution(mincostToHireWorkers)