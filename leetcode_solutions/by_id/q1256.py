# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1256
标题: Rank Transform of an Array
难度: easy
链接: https://leetcode.cn/problems/rank-transform-of-an-array/
题目类型: 数组、哈希表、排序
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1331. 数组序号转换 - 给你一个整数数组 arr ，请你将数组中的每个元素替换为它们排序后的序号。 序号代表了一个元素有多大。序号编号的规则如下： * 序号从 1 开始编号。 * 一个元素越大，那么序号越大。如果两个元素相等，那么它们的序号相同。 * 每个数字的序号都应该尽可能地小。 示例 1： 输入：arr = [40,10,20,30] 输出：[4,1,2,3] 解释：40 是最大的元素。 10 是最小的元素。 20 是第二小的数字。 30 是第三小的数字。 示例 2： 输入：arr = [100,100,100] 输出：[1,1,1] 解释：所有元素有相同的序号。 示例 3： 输入：arr = [37,12,28,9,100,56,80,5,12] 输出：[5,3,4,2,8,6,7,1,3] 提示： * 0 <= arr.length <= 105 * -109 <= arr[i] <= 109
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用哈希表记录每个元素的排名，并通过排序来确定每个元素的排名。

算法步骤:
1. 创建一个哈希表 `rank_map` 来存储每个元素及其对应的排名。
2. 将数组去重并排序，得到一个新的有序数组 `sorted_unique_arr`。
3. 遍历 `sorted_unique_arr`，为每个元素分配一个排名，并将其存储在 `rank_map` 中。
4. 遍历原始数组 `arr`，根据 `rank_map` 替换每个元素为其对应的排名。

关键点:
- 使用去重和排序来确定每个元素的排名。
- 使用哈希表来快速查找每个元素的排名。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log n)，其中 n 是数组的长度。主要的时间开销在于排序操作。
空间复杂度: O(n)，需要额外的空间来存储哈希表和去重后的数组。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def arrayRankTransform(arr: List[int]) -> List[int]:
    """
    函数式接口 - 将数组中的每个元素替换为它们排序后的序号。
    """
    # 创建一个哈希表来存储每个元素及其对应的排名
    rank_map = {}
    
    # 将数组去重并排序
    sorted_unique_arr = sorted(set(arr))
    
    # 为每个元素分配一个排名
    for i, num in enumerate(sorted_unique_arr, start=1):
        rank_map[num] = i
    
    # 替换每个元素为其对应的排名
    return [rank_map[num] for num in arr]

Solution = create_solution(arrayRankTransform)