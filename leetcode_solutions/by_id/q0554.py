# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 554
标题: Brick Wall
难度: medium
链接: https://leetcode.cn/problems/brick-wall/
题目类型: 数组、哈希表
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
554. 砖墙 - 你的面前有一堵矩形的、由 n 行砖块组成的砖墙。这些砖块高度相同（也就是一个单位高）但是宽度不同。每一行砖块的宽度之和相等。 你现在要画一条 自顶向下 的、穿过 最少 砖块的垂线。如果你画的线只是从砖块的边缘经过，就不算穿过这块砖。你不能沿着墙的两个垂直边缘之一画线，这样显然是没有穿过一块砖的。 给你一个二维数组 wall ，该数组包含这堵墙的相关信息。其中，wall[i] 是一个代表从左至右每块砖的宽度的数组。你需要找出怎样画才能使这条线 穿过的砖块数量最少 ，并且返回 穿过的砖块数量 。 示例 1： [https://assets.leetcode.com/uploads/2025/01/17/a.png] 输入：wall = [[1,2,2,1],[3,1,2],[1,3,2],[2,4],[3,1,2],[1,3,1,1]] 输出：2 示例 2： 输入：wall = [[1],[1],[1]] 输出：3 提示： * n == wall.length * 1 <= n <= 104 * 1 <= wall[i].length <= 104 * 1 <= sum(wall[i].length) <= 2 * 104 * 对于每一行 i ，sum(wall[i]) 是相同的 * 1 <= wall[i][j] <= 231 - 1
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用哈希表记录每个砖缝的位置，并统计每个位置出现的次数。选择出现次数最多的砖缝位置，这样穿过的砖块数最少。

算法步骤:
1. 初始化一个哈希表来记录每个砖缝的位置及其出现次数。
2. 遍历每一行砖块，计算每个砖缝的位置，并在哈希表中更新该位置的计数。
3. 找出哈希表中最大值的位置，即为穿过的砖块数最少的位置。
4. 返回总行数减去最大值，即为穿过的砖块数。

关键点:
- 使用前缀和的思想来计算每个砖缝的位置。
- 通过哈希表记录每个位置的出现次数，找到出现次数最多的位置。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n * m)，其中 n 是墙的高度，m 是每行砖块的最大数量。
空间复杂度: O(n * m)，最坏情况下哈希表需要存储所有的砖缝位置。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def solution_function_name(wall: List[List[int]]) -> int:
    """
    函数式接口 - 找到穿过的砖块数最少的垂线
    """
    from collections import defaultdict

    # 哈希表记录每个砖缝的位置及其出现次数
    edge_count = defaultdict(int)

    for row in wall:
        edge_position = 0
        for brick in row[:-1]:  # 不包括最后一块砖的右边
            edge_position += brick
            edge_count[edge_position] += 1

    # 找出出现次数最多的砖缝位置
    max_edges = max(edge_count.values(), default=0)

    # 返回穿过的砖块数
    return len(wall) - max_edges


Solution = create_solution(solution_function_name)