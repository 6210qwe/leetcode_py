# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 528
标题: Swapping Nodes in a Linked List
难度: medium
链接: https://leetcode.cn/problems/swapping-nodes-in-a-linked-list/
题目类型: 链表、双指针
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1721. 交换链表中的节点 - 给你链表的头节点 head 和一个整数 k 。 交换 链表正数第 k 个节点和倒数第 k 个节点的值后，返回链表的头节点（链表 从 1 开始索引）。 示例 1： [https://assets.leetcode.cn/aliyun-lc-upload/uploads/2021/01/10/linked1.jpg] 输入：head = [1,2,3,4,5], k = 2 输出：[1,4,3,2,5] 示例 2： 输入：head = [7,9,6,6,7,8,3,0,9,5], k = 5 输出：[7,9,6,6,8,7,3,0,9,5] 示例 3： 输入：head = [1], k = 1 输出：[1] 示例 4： 输入：head = [1,2], k = 1 输出：[2,1] 示例 5： 输入：head = [1,2,3], k = 2 输出：[1,2,3] 提示： * 链表中节点的数目是 n * 1 <= k <= n <= 105 * 0 <= Node.val <= 100
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用双指针找到正数第 k 个节点和倒数第 k 个节点，然后交换它们的值。

算法步骤:
1. 初始化两个指针 first 和 second，都指向链表的头节点。
2. 将 first 指针向前移动 k-1 步，使其指向正数第 k 个节点。
3. 保持 first 不动，将 second 指针从头节点开始移动，直到 first 指针到达链表末尾。此时 second 指针指向倒数第 k 个节点。
4. 交换 first 和 second 指针所指向节点的值。
5. 返回链表的头节点。

关键点:
- 使用双指针法可以同时找到正数第 k 个节点和倒数第 k 个节点。
- 只交换节点的值，而不是节点本身，这样可以简化操作。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)，其中 n 是链表的长度。我们只需要遍历链表一次。
空间复杂度: O(1)，只使用了常数级的额外空间。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.solution import create_solution

def swap_nodes(head: Optional[ListNode], k: int) -> Optional[ListNode]:
    """
    交换链表中的节点 - 给你链表的头节点 head 和一个整数 k 。 交换 链表正数第 k 个节点和倒数第 k 个节点的值后，返回链表的头节点（链表 从 1 开始索引）。
    """
    # 初始化两个指针 first 和 second，都指向链表的头节点
    first = second = head
    
    # 将 first 指针向前移动 k-1 步，使其指向正数第 k 个节点
    for _ in range(k - 1):
        first = first.next
    
    # 保存正数第 k 个节点
    first_k_node = first
    
    # 保持 first 不动，将 second 指针从头节点开始移动，直到 first 指针到达链表末尾
    while first.next:
        first = first.next
        second = second.next
    
    # 交换 first 和 second 指针所指向节点的值
    first_k_node.val, second.val = second.val, first_k_node.val
    
    # 返回链表的头节点
    return head

Solution = create_solution(swap_nodes)