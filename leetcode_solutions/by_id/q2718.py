# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2718
标题: Minimum Operations to Make All Array Elements Equal
难度: medium
链接: https://leetcode.cn/problems/minimum-operations-to-make-all-array-elements-equal/
题目类型: 数组、二分查找、前缀和、排序
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2602. 使数组元素全部相等的最少操作次数 - 给你一个正整数数组 nums 。 同时给你一个长度为 m 的整数数组 queries 。第 i 个查询中，你需要将 nums 中所有元素变成 queries[i] 。你可以执行以下操作 任意 次： * 将数组里一个元素 增大 或者 减小 1 。 请你返回一个长度为 m 的数组 answer ，其中 answer[i]是将 nums 中所有元素变成 queries[i] 的 最少 操作次数。 注意，每次查询后，数组变回最开始的值。 示例 1： 输入：nums = [3,1,6,8], queries = [1,5] 输出：[14,10] 解释：第一个查询，我们可以执行以下操作： - 将 nums[0] 减小 2 次，nums = [1,1,6,8] 。 - 将 nums[2] 减小 5 次，nums = [1,1,1,8] 。 - 将 nums[3] 减小 7 次，nums = [1,1,1,1] 。 第一个查询的总操作次数为 2 + 5 + 7 = 14 。 第二个查询，我们可以执行以下操作： - 将 nums[0] 增大 2 次，nums = [5,1,6,8] 。 - 将 nums[1] 增大 4 次，nums = [5,5,6,8] 。 - 将 nums[2] 减小 1 次，nums = [5,5,5,8] 。 - 将 nums[3] 减小 3 次，nums = [5,5,5,5] 。 第二个查询的总操作次数为 2 + 4 + 1 + 3 = 10 。 示例 2： 输入：nums = [2,9,6,3], queries = [10] 输出：[20] 解释：我们可以将数组中所有元素都增大到 10 ，总操作次数为 8 + 1 + 4 + 7 = 20 。 提示： * n == nums.length * m == queries.length * 1 <= n, m <= 105 * 1 <= nums[i], queries[i] <= 109
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用前缀和来快速计算每个查询的操作次数。

算法步骤:
1. 对数组进行排序。
2. 计算前缀和数组。
3. 对于每个查询，使用二分查找找到目标值的位置，并计算操作次数。

关键点:
- 通过前缀和和二分查找，可以在 O(log n) 时间内找到目标值的位置，并在 O(1) 时间内计算操作次数。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log n + m log n)，其中 n 是 nums 的长度，m 是 queries 的长度。排序的时间复杂度是 O(n log n)，每个查询的时间复杂度是 O(log n)。
空间复杂度: O(n)，用于存储前缀和数组。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List
import bisect

def min_operations(nums: List[int], queries: List[int]) -> List[int]:
    """
    计算将数组中的所有元素变为查询值所需的最小操作次数。
    
    :param nums: 初始数组
    :param queries: 查询数组
    :return: 每个查询的最小操作次数
    """
    n = len(nums)
    nums.sort()
    prefix_sum = [0] * (n + 1)
    for i in range(n):
        prefix_sum[i + 1] = prefix_sum[i] + nums[i]
    
    def get_operations(target: int) -> int:
        idx = bisect.bisect_left(nums, target)
        left_sum = target * idx - prefix_sum[idx]
        right_sum = (prefix_sum[n] - prefix_sum[idx]) - target * (n - idx)
        return left_sum + right_sum
    
    return [get_operations(q) for q in queries]

Solution = create_solution(min_operations)