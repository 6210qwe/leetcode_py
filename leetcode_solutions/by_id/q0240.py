# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 240
标题: Search a 2D Matrix II
难度: medium
链接: https://leetcode.cn/problems/search-a-2d-matrix-ii/
题目类型: 数组、二分查找、分治、矩阵
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
240. 搜索二维矩阵 II - 编写一个高效的算法来搜索 m x n 矩阵 matrix 中的一个目标值 target 。该矩阵具有以下特性： * 每行的元素从左到右升序排列。 * 每列的元素从上到下升序排列。 示例 1： [https://assets.leetcode.cn/aliyun-lc-upload/uploads/2020/11/25/searchgrid2.jpg] 输入：matrix = [[1,4,7,11,15],[2,5,8,12,19],[3,6,9,16,22],[10,13,14,17,24],[18,21,23,26,30]], target = 5 输出：true 示例 2： [https://assets.leetcode.cn/aliyun-lc-upload/uploads/2020/11/25/searchgrid.jpg] 输入：matrix = [[1,4,7,11,15],[2,5,8,12,19],[3,6,9,16,22],[10,13,14,17,24],[18,21,23,26,30]], target = 20 输出：false 提示： * m == matrix.length * n == matrix[i].length * 1 <= n, m <= 300 * -109 <= matrix[i][j] <= 109 * 每行的所有元素从左到右升序排列 * 每列的所有元素从上到下升序排列 * -109 <= target <= 109
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 从右上角开始搜索，如果当前值大于target，向左移动；如果小于target，向下移动

算法步骤:
1. 从矩阵的右上角开始
2. 如果当前值等于target，返回True
3. 如果当前值大于target，向左移动（列减1）
4. 如果当前值小于target，向下移动（行加1）
5. 如果越界，返回False

关键点:
- 利用矩阵的排序性质，从右上角或左下角开始搜索
- 时间复杂度O(m+n)，空间复杂度O(1)
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(m+n) - 最多遍历m+n个元素
空间复杂度: O(1) - 只使用常数额外空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List
from leetcode_solutions.utils.solution import create_solution


def search_a_2d_matrix_ii(matrix: List[List[int]], target: int) -> bool:
    """
    函数式接口 - 搜索二维矩阵II
    
    实现思路:
    从右上角开始搜索，如果当前值大于target，向左移动；如果小于target，向下移动。
    
    Args:
        matrix: 二维矩阵
        target: 目标值
        
    Returns:
        是否找到目标值
        
    Example:
        >>> search_a_2d_matrix_ii([[1,4,7,11,15],[2,5,8,12,19],[3,6,9,16,22],[10,13,14,17,24],[18,21,23,26,30]], 5)
        True
    """
    if not matrix or not matrix[0]:
        return False
    
    m, n = len(matrix), len(matrix[0])
    row, col = 0, n - 1
    
    while row < m and col >= 0:
        if matrix[row][col] == target:
            return True
        elif matrix[row][col] > target:
            col -= 1
        else:
            row += 1
    
    return False


# 自动生成Solution类（无需手动编写）
Solution = create_solution(search_a_2d_matrix_ii)
