# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 12
标题: Integer to Roman
难度: medium
链接: https://leetcode.cn/problems/integer-to-roman/
题目类型: 哈希表、数学、字符串
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
12. 整数转罗马数字 - 七个不同的符号代表罗马数字，其值如下： 符号 值 I 1 V 5 X 10 L 50 C 100 D 500 M 1000 罗马数字是通过添加从最高到最低的小数位值的转换而形成的。将小数位值转换为罗马数字有以下规则： * 如果该值不是以 4 或 9 开头，请选择可以从输入中减去的最大值的符号，将该符号附加到结果，减去其值，然后将其余部分转换为罗马数字。 * 如果该值以 4 或 9 开头，使用 减法形式，表示从以下符号中减去一个符号，例如 4 是 5 (V) 减 1 (I): IV ，9 是 10 (X) 减 1 (I)：IX。仅使用以下减法形式：4 (IV)，9 (IX)，40 (XL)，90 (XC)，400 (CD) 和 900 (CM)。 * 只有 10 的次方（I, X, C, M）最多可以连续附加 3 次以代表 10 的倍数。你不能多次附加 5 (V)，50 (L) 或 500 (D)。如果需要将符号附加4次，请使用 减法形式。 给定一个整数，将其转换为罗马数字。 示例 1： 输入：num = 3749 输出： "MMMDCCXLIX" 解释： 3000 = MMM 由于 1000 (M) + 1000 (M) + 1000 (M) 700 = DCC 由于 500 (D) + 100 (C) + 100 (C) 40 = XL 由于 50 (L) 减 10 (X) 9 = IX 由于 10 (X) 减 1 (I) 注意：49 不是 50 (L) 减 1 (I) 因为转换是基于小数位 示例 2： 输入：num = 58 输出："LVIII" 解释： 50 = L 8 = VIII 示例 3： 输入：num = 1994 输出："MCMXCIV" 解释： 1000 = M 900 = CM 90 = XC 4 = IV 提示： * 1 <= num <= 3999
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 贪心算法，从大到小依次处理每个罗马数字符号

算法步骤:
1. 定义所有可能的罗马数字符号及其对应的值（包括减法形式）
2. 按照值从大到小排序
3. 对于每个符号，尽可能多地使用它
4. 将使用的符号添加到结果字符串中
5. 从num中减去已使用的值
6. 重复步骤3-5直到num为0

关键点:
- 包括所有减法形式：IV, IX, XL, XC, CD, CM
- 按照值从大到小处理，确保优先使用较大的符号
- 时间复杂度O(1)，因为符号数量固定
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(1) - 符号数量固定（13个），最多处理固定次数
空间复杂度: O(1) - 只使用常数额外空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def int_to_roman(num: int) -> str:
    """
    函数式接口 - 贪心算法实现
    
    实现思路:
    从大到小依次处理每个罗马数字符号，尽可能多地使用每个符号。
    
    Args:
        num: 输入的整数（1-3999）
        
    Returns:
        对应的罗马数字字符串
        
    Example:
        >>> int_to_roman(3749)
        'MMMDCCXLIX'
        >>> int_to_roman(58)
        'LVIII'
        >>> int_to_roman(1994)
        'MCMXCIV'
    """
    # 定义所有罗马数字符号（包括减法形式），按值从大到小排序
    values = [1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1]
    symbols = ["M", "CM", "D", "CD", "C", "XC", "L", "XL", "X", "IX", "V", "IV", "I"]
    
    result = []
    for i, value in enumerate(values):
        count = num // value
        if count > 0:
            result.append(symbols[i] * count)
            num %= value
    
    return ''.join(result)


# 自动生成Solution类（无需手动编写）
Solution = create_solution(int_to_roman)
