# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 197
标题: Rising Temperature
难度: easy
链接: https://leetcode.cn/problems/rising-temperature/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
197. 上升的温度 - 表： Weather +---------------+---------+ | Column Name | Type | +---------------+---------+ | id | int | | recordDate | date | | temperature | int | +---------------+---------+ id 是该表具有唯一值的列。 没有具有相同 recordDate 的不同行。 该表包含特定日期的温度信息 编写解决方案，找出与之前（昨天的）日期相比温度更高的所有日期的 id 。 返回结果 无顺序要求 。 结果格式如下例子所示。 示例 1： 输入： Weather 表： +----+------------+-------------+ | id | recordDate | Temperature | +----+------------+-------------+ | 1 | 2015-01-01 | 10 | | 2 | 2015-01-02 | 25 | | 3 | 2015-01-03 | 20 | | 4 | 2015-01-04 | 30 | +----+------------+-------------+ 输出： +----+ | id | +----+ | 2 | | 4 | +----+ 解释： 2015-01-02 的温度比前一天高（10 -> 25） 2015-01-04 的温度比前一天高（20 -> 30）
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: SQL自连接查询，使用DATEDIFF函数比较日期

算法步骤:
1. 使用自连接，连接条件为日期相差1天
2. 筛选温度更高的记录
3. 返回id

关键点:
- 使用DATEDIFF函数比较日期
- SQL查询语句
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n^2) - 自连接的时间复杂度
空间复杂度: O(n) - 连接结果的空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def rising_temperature():
    """
    函数式接口 - 上升的温度（SQL查询）
    
    实现思路:
    使用自连接查询，使用DATEDIFF函数比较日期。
    
    Returns:
        SQL查询语句字符串
        
    Example:
        >>> sql = rising_temperature()
        >>> # 执行SQL查询
    """
    sql = """
    SELECT w1.id
    FROM Weather w1
    JOIN Weather w2 ON DATEDIFF(w1.recordDate, w2.recordDate) = 1
    WHERE w1.temperature > w2.temperature
    """
    return sql.strip()


# 自动生成Solution类（无需手动编写）
Solution = create_solution(rising_temperature)
