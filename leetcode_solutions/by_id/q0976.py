# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 976
标题: Minimum Area Rectangle
难度: medium
链接: https://leetcode.cn/problems/minimum-area-rectangle/
题目类型: 几何、数组、哈希表、数学、排序
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
939. 最小面积矩形 - 给你一个 X-Y 平面上的点数组 points，其中 points[i] = [xi, yi]。 返回由这些点形成的矩形的最小面积，矩形的边与 X 轴和 Y 轴平行。如果不存在这样的矩形，则返回 0。 示例 1： [https://assets.leetcode.com/uploads/2021/08/03/rec1.JPG] 输入： points = [[1,1],[1,3],[3,1],[3,3],[2,2]] 输出： 4 示例 2： [https://assets.leetcode.com/uploads/2021/08/03/rec2.JPG] 输入： points = [[1,1],[1,3],[3,1],[3,3],[4,1],[4,3]] 输出： 2 提示： * 1 <= points.length <= 500 * points[i].length == 2 * 0 <= xi, yi <= 4 * 104 * 所有给定的点都是 唯一 的。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用哈希表来存储每个 x 坐标对应的 y 坐标集合，然后遍历所有可能的对角线组合，检查是否存在其他两个顶点。

算法步骤:
1. 使用一个字典来存储每个 x 坐标对应的 y 坐标集合。
2. 遍历所有可能的对角线组合 (x1, y1) 和 (x2, y2)，检查是否存在其他两个顶点 (x1, y2) 和 (x2, y1)。
3. 如果存在，计算矩形的面积并更新最小面积。

关键点:
- 使用哈希表来快速查找 y 坐标。
- 只需要遍历一次点集，时间复杂度为 O(n^2)。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n^2)
空间复杂度: O(n)
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def min_area_rect(points: List[List[int]]) -> int:
    """
    返回由这些点形成的矩形的最小面积，矩形的边与 X 轴和 Y 轴平行。如果不存在这样的矩形，则返回 0。
    """
    from collections import defaultdict

    # 存储每个 x 坐标对应的 y 坐标集合
    x_to_ys = defaultdict(set)
    for x, y in points:
        x_to_ys[x].add(y)

    min_area = float('inf')
    last_x = {}

    for x in sorted(x_to_ys):
        ys = list(x_to_ys[x])
        for i in range(len(ys)):
            for j in range(i):
                y1, y2 = ys[j], ys[i]
                if (y1, y2) in last_x:
                    area = (x - last_x[y1, y2]) * abs(y2 - y1)
                    min_area = min(min_area, area)
                last_x[y1, y2] = x

    return min_area if min_area < float('inf') else 0

Solution = create_solution(min_area_rect)