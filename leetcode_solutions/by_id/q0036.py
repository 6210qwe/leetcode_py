# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 36
标题: Valid Sudoku
难度: medium
链接: https://leetcode.cn/problems/valid-sudoku/
题目类型: 数组、哈希表、矩阵
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
36. 有效的数独 - 请你判断一个 9 x 9 的数独是否有效。只需要 根据以下规则 ，验证已经填入的数字是否有效即可。 1. 数字 1-9 在每一行只能出现一次。 2. 数字 1-9 在每一列只能出现一次。 3. 数字 1-9 在每一个以粗实线分隔的 3x3 宫内只能出现一次。（请参考示例图） 注意： * 一个有效的数独（部分已被填充）不一定是可解的。 * 只需要根据以上规则，验证已经填入的数字是否有效即可。 * 空白格用 '.' 表示。 示例 1： [https://assets.leetcode.cn/aliyun-lc-upload/uploads/2021/04/12/250px-sudoku-by-l2g-20050714svg.png] 输入：board = [["5","3",".",".","7",".",".",".","."] ,["6",".",".","1","9","5",".",".","."] ,[".","9","8",".",".",".",".","6","."] ,["8",".",".",".","6",".",".",".","3"] ,["4",".",".","8",".","3",".",".","1"] ,["7",".",".",".","2",".",".",".","6"] ,[".","6",".",".",".",".","2","8","."] ,[".",".",".","4","1","9",".",".","5"] ,[".",".",".",".","8",".",".","7","9"]] 输出：true 示例 2： 输入：board = [["8","3",".",".","7",".",".",".","."] ,["6",".",".","1","9","5",".",".","."] ,[".","9","8",".",".",".",".","6","."] ,["8",".",".",".","6",".",".",".","3"] ,["4",".",".","8",".","3",".",".","1"] ,["7",".",".",".","2",".",".",".","6"] ,[".","6",".",".",".",".","2","8","."] ,[".",".",".","4","1","9",".",".","5"] ,[".",".",".",".","8",".",".","7","9"]] 输出：false 解释：除了第一行的第一个数字从 5 改为 8 以外，空格内其他数字均与 示例1 相同。 但由于位于左上角的 3x3 宫内有两个 8 存在, 因此这个数独是无效的。 提示： * board.length == 9 * board[i].length == 9 * board[i][j] 是一位数字（1-9）或者 '.'
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用三个集合分别检查行、列、3x3宫格中数字是否重复

算法步骤:
1. 遍历9x9数独板
2. 对于每个数字，检查其所在行、列、3x3宫格是否已存在
3. 使用集合存储已出现的数字，快速判断重复

关键点:
- 使用集合快速查找
- 时间复杂度O(1)（固定81个格子），空间复杂度O(1)
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(1) - 固定81个格子
空间复杂度: O(1) - 固定大小的集合
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List
from leetcode_solutions.utils.solution import create_solution


def valid_sudoku(board: List[List[str]]) -> bool:
    """
    函数式接口 - 有效的数独
    
    实现思路:
    使用三个集合分别检查行、列、3x3宫格中数字是否重复。
    
    Args:
        board: 9x9数独板
        
    Returns:
        是否是有效的数独
        
    Example:
        >>> valid_sudoku([["5","3",".",".","7",".",".",".","."],["6",".",".","1","9","5",".",".","."],[".","9","8",".",".",".",".","6","."],["8",".",".",".","6",".",".",".","3"],["4",".",".","8",".","3",".",".","1"],["7",".",".",".","2",".",".",".","6"],[".","6",".",".",".",".","2","8","."],[".",".",".","4","1","9",".",".","5"],[".",".",".",".","8",".",".","7","9"]])
        True
    """
    rows = [set() for _ in range(9)]
    cols = [set() for _ in range(9)]
    boxes = [set() for _ in range(9)]
    
    for i in range(9):
        for j in range(9):
            num = board[i][j]
            if num == '.':
                continue
            
            # 检查行
            if num in rows[i]:
                return False
            rows[i].add(num)
            
            # 检查列
            if num in cols[j]:
                return False
            cols[j].add(num)
            
            # 检查3x3宫格
            box_idx = (i // 3) * 3 + j // 3
            if num in boxes[box_idx]:
                return False
            boxes[box_idx].add(num)
    
    return True


# 自动生成Solution类（无需手动编写）
Solution = create_solution(valid_sudoku)
