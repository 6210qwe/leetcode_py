# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 183
标题: Customers Who Never Order
难度: easy
链接: https://leetcode.cn/problems/customers-who-never-order/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
183. 从不订购的客户 - Customers 表： +-------------+---------+ | Column Name | Type | +-------------+---------+ | id | int | | name | varchar | +-------------+---------+ 在 SQL 中，id 是该表的主键。 该表的每一行都表示客户的 ID 和名称。 Orders 表： +-------------+------+ | Column Name | Type | +-------------+------+ | id | int | | customerId | int | +-------------+------+ 在 SQL 中，id 是该表的主键。 customerId 是 Customers 表中 ID 的外键( Pandas 中的连接键)。 该表的每一行都表示订单的 ID 和订购该订单的客户的 ID。 找出所有从不点任何东西的顾客。 以 任意顺序 返回结果表。 结果格式如下所示。 示例 1： 输入： Customers table: +----+-------+ | id | name | +----+-------+ | 1 | Joe | | 2 | Henry | | 3 | Sam | | 4 | Max | +----+-------+ Orders table: +----+------------+ | id | customerId | +----+------------+ | 1 | 3 | | 2 | 1 | +----+------------+ 输出： +-----------+ | Customers | +-----------+ | Henry | | Max | +-----------+
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: SQL LEFT JOIN或NOT IN查找没有订单的客户

算法步骤:
1. 使用LEFT JOIN连接Customers和Orders表
2. 筛选Orders.id为NULL的记录
3. 或者使用NOT IN子查询

关键点:
- 使用LEFT JOIN或NOT IN查找不存在的记录
- SQL查询语句
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n+m) - n和m分别是两个表的记录数
空间复杂度: O(n) - 连接结果的空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def customers_who_never_order():
    """
    函数式接口 - 从不订购的客户（SQL查询）
    
    实现思路:
    使用LEFT JOIN或NOT IN查找没有订单的客户。
    
    Returns:
        SQL查询语句字符串
        
    Example:
        >>> sql = customers_who_never_order()
        >>> # 执行SQL查询
    """
    sql = """
    SELECT c.name AS Customers
    FROM Customers c
    LEFT JOIN Orders o ON c.id = o.customerId
    WHERE o.id IS NULL
    """
    return sql.strip()


# 自动生成Solution类（无需手动编写）
Solution = create_solution(customers_who_never_order)
