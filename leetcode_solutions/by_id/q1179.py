# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1179
标题: Game Play Analysis I
难度: easy
链接: https://leetcode.cn/problems/game-play-analysis-i/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
511. 游戏玩法分析 I - 活动表 Activity： +--------------+---------+ | Column Name | Type | +--------------+---------+ | player_id | int | | device_id | int | | event_date | date | | games_played | int | +--------------+---------+ 在 SQL 中，表的主键是 (player_id, event_date)。 这张表展示了一些游戏玩家在游戏平台上的行为活动。 每行数据记录了一名玩家在退出平台之前，当天使用同一台设备登录平台后打开的游戏的数目（可能是 0 个）。 查询每位玩家 第一次登录平台的日期。 查询结果的格式如下所示： Activity 表： +-----------+-----------+------------+--------------+ | player_id | device_id | event_date | games_played | +-----------+-----------+------------+--------------+ | 1 | 2 | 2016-03-01 | 5 | | 1 | 2 | 2016-05-02 | 6 | | 2 | 3 | 2017-06-25 | 1 | | 3 | 1 | 2016-03-02 | 0 | | 3 | 4 | 2018-07-03 | 5 | +-----------+-----------+------------+--------------+ Result 表： +-----------+-------------+ | player_id | first_login | +-----------+-------------+ | 1 | 2016-03-01 | | 2 | 2017-06-25 | | 3 | 2016-03-02 | +-----------+-------------+
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用Pandas库进行数据处理，找到每个玩家的第一次登录日期。

算法步骤:
1. 读取Activity表。
2. 按player_id分组，并找到每个玩家最早的event_date。
3. 重命名列并返回结果。

关键点:
- 使用Pandas的groupby和min函数来高效地找到每个玩家的最早登录日期。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)，其中n是Activity表的行数。因为我们需要遍历整个表来找到每个玩家的最早登录日期。
空间复杂度: O(m)，其中m是不同player_id的数量。存储每个玩家的最早登录日期需要额外的空间。
"""

# ============================================================================
# 代码实现
# ============================================================================

import pandas as pd


def game_analysis(activity: pd.DataFrame) -> pd.DataFrame:
    """
    函数式接口 - 实现游戏玩法分析I
    """
    # 按player_id分组，并找到每个玩家最早的event_date
    first_login = activity.groupby('player_id')['event_date'].min().reset_index()
    
    # 重命名列
    first_login.columns = ['player_id', 'first_login']
    
    return first_login


Solution = create_solution(game_analysis)