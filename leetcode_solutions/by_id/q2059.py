# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2059
标题: Unique Length-3 Palindromic Subsequences
难度: medium
链接: https://leetcode.cn/problems/unique-length-3-palindromic-subsequences/
题目类型: 位运算、哈希表、字符串、前缀和
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1930. 长度为 3 的不同回文子序列 - 给你一个字符串 s ，返回 s 中 长度为 3 的不同回文子序列 的个数。 即便存在多种方法来构建相同的子序列，但相同的子序列只计数一次。 回文 是正着读和反着读一样的字符串。 子序列 是由原字符串删除其中部分字符（也可以不删除）且不改变剩余字符之间相对顺序形成的一个新字符串。 * 例如，"ace" 是 "abcde" 的一个子序列。 示例 1： 输入：s = "aabca" 输出：3 解释：长度为 3 的 3 个回文子序列分别是： - "aba" ("aabca" 的子序列) - "aaa" ("aabca" 的子序列) - "aca" ("aabca" 的子序列) 示例 2： 输入：s = "adc" 输出：0 解释："adc" 不存在长度为 3 的回文子序列。 示例 3： 输入：s = "bbcbaba" 输出：4 解释：长度为 3 的 4 个回文子序列分别是： - "bbb" ("bbcbaba" 的子序列) - "bcb" ("bbcbaba" 的子序列) - "bab" ("bbcbaba" 的子序列) - "aba" ("bbcbaba" 的子序列) 提示： * 3 <= s.length <= 105 * s 仅由小写英文字母组成
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用哈希表记录每个字符的最左和最右出现位置，然后遍历所有可能的中间字符，检查是否存在不同的左右字符。

算法步骤:
1. 初始化两个字典 left 和 right，分别记录每个字符的最左和最右出现位置。
2. 遍历字符串，更新 left 和 right 字典。
3. 遍历所有可能的中间字符，对于每个中间字符，检查是否存在不同的左右字符，并计数。

关键点:
- 使用哈希表记录字符的位置，避免重复计算。
- 通过遍历所有可能的中间字符，确保找到所有长度为 3 的回文子序列。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)
空间复杂度: O(1)（因为字母表大小固定为 26）
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def count_unique_palindromic_subsequences(s: str) -> int:
    """
    函数式接口 - 返回字符串 s 中长度为 3 的不同回文子序列的个数
    """
    # 初始化 left 和 right 字典
    left, right = {}, {}
    
    # 更新 left 和 right 字典
    for i, char in enumerate(s):
        if char not in left:
            left[char] = i
        right[char] = i
    
    count = 0
    # 遍历所有可能的中间字符
    for char in set(s):
        for mid_char in set(s[left[char] + 1:right[char]]):
            if mid_char != char:
                count += 1
    
    return count


Solution = create_solution(count_unique_palindromic_subsequences)