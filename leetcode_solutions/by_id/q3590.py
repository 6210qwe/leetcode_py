# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 3590
标题: Maximum Total Area Occupied by Pistons
难度: hard
链接: https://leetcode.cn/problems/maximum-total-area-occupied-by-pistons/
题目类型: 数组、哈希表、字符串、计数、前缀和、模拟
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
3279. 活塞占据的最大总区域 - 备战技术面试？力扣提供海量技术面试资源，帮助你高效提升编程技能,轻松拿下世界 IT 名企 Dream Offer。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用优先队列（堆）来维护当前活塞的宽度和位置，以确保在每个时刻都能找到最大面积。

算法步骤:
1. 初始化一个最小堆，用于存储活塞的右边界及其对应的宽度。
2. 遍历所有活塞，对于每个活塞：
   - 将其右边界和宽度加入堆中。
   - 移除堆中所有已经过期的活塞（即右边界小于当前左边界）。
   - 计算当前时刻的最大面积，并更新结果。
3. 返回最大面积。

关键点:
- 使用最小堆来高效地管理活塞的右边界和宽度。
- 在遍历过程中及时移除过期的活塞，以确保堆中的数据有效。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log n)，其中 n 是活塞的数量。因为每次插入和删除堆的操作都是 O(log n) 的。
空间复杂度: O(n)，因为堆中最多会存储 n 个活塞的信息。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List
import heapq

def solution_function_name(pistons: List[List[int]]) -> int:
    """
    函数式接口 - 计算活塞占据的最大总区域
    """
    # 初始化最小堆
    heap = []
    max_area = 0
    current_width = 0
    
    for left, right, width in sorted(pistons):
        # 将当前活塞的右边界和宽度加入堆中
        heapq.heappush(heap, (right, width))
        current_width += width
        
        # 移除堆中所有已经过期的活塞
        while heap and heap[0][0] < left:
            _, expired_width = heapq.heappop(heap)
            current_width -= expired_width
        
        # 计算当前时刻的最大面积
        max_area = max(max_area, (right - left + 1) * current_width)
    
    return max_area


Solution = create_solution(solution_function_name)