# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 176
标题: Second Highest Salary
难度: medium
链接: https://leetcode.cn/problems/second-highest-salary/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
176. 第二高的薪水 - Employee 表： +-------------+------+ | Column Name | Type | +-------------+------+ | id | int | | salary | int | +-------------+------+ id 是这个表的主键。 表的每一行包含员工的工资信息。 查询并返回 Employee 表中第二高的 不同 薪水 。如果不存在第二高的薪水，查询应该返回 null(Pandas 则返回 None) 。 查询结果如下例所示。 示例 1： 输入： Employee 表： +----+--------+ | id | salary | +----+--------+ | 1 | 100 | | 2 | 200 | | 3 | 300 | +----+--------+ 输出： +---------------------+ | SecondHighestSalary | +---------------------+ | 200 | +---------------------+ 示例 2： 输入： Employee 表： +----+--------+ | id | salary | +----+--------+ | 1 | 100 | +----+--------+ 输出： +---------------------+ | SecondHighestSalary | +---------------------+ | null | +---------------------+
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: SQL查询，使用DISTINCT和LIMIT获取第二高的薪水

算法步骤:
1. 使用DISTINCT去重
2. 按salary降序排序
3. 使用LIMIT 1 OFFSET 1获取第二高的记录
4. 使用子查询处理不存在的情况

关键点:
- 使用DISTINCT去重，LIMIT和OFFSET获取第二高
- SQL查询语句
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(nlogn) - 排序的时间复杂度
空间复杂度: O(1) - 只返回一条记录
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def second_highest_salary():
    """
    函数式接口 - 查询第二高的薪水（SQL查询）
    
    实现思路:
    使用DISTINCT和LIMIT获取第二高的薪水。
    
    Returns:
        SQL查询语句字符串
        
    Example:
        >>> sql = second_highest_salary()
        >>> # 执行SQL查询
    """
    sql = """
    SELECT (
        SELECT DISTINCT salary
        FROM Employee
        ORDER BY salary DESC
        LIMIT 1 OFFSET 1
    ) AS SecondHighestSalary
    """
    return sql.strip()


# 自动生成Solution类（无需手动编写）
Solution = create_solution(second_highest_salary)
