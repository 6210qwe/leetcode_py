# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1422
标题: Divide Array in Sets of K Consecutive Numbers
难度: medium
链接: https://leetcode.cn/problems/divide-array-in-sets-of-k-consecutive-numbers/
题目类型: 贪心、数组、哈希表、排序
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1296. 划分数组为连续数字的集合 - 给你一个整数数组 nums 和一个正整数 k，请你判断是否可以把这个数组划分成一些由 k 个连续数字组成的集合。 如果可以，请返回 true；否则，返回 false。 示例 1： 输入：nums = [1,2,3,3,4,4,5,6], k = 4 输出：true 解释：数组可以分成 [1,2,3,4] 和 [3,4,5,6]。 示例 2： 输入：nums = [3,2,1,2,3,4,3,4,5,9,10,11], k = 3 输出：true 解释：数组可以分成 [1,2,3] , [2,3,4] , [3,4,5] 和 [9,10,11]。 示例 4： 输入：nums = [1,2,3,4], k = 3 输出：false 解释：数组不能分成几个大小为 3 的子数组。 提示： * 1 <= k <= nums.length <= 105 * 1 <= nums[i] <= 109 注意：此题目与 846 重复：https://leetcode.cn/problems/hand-of-straights/ [https://leetcode.cn/problems/hand-of-straights/]
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用贪心算法和哈希表来判断数组是否可以划分为 k 个连续数字的集合。

算法步骤:
1. 统计每个数字出现的次数。
2. 将数组排序。
3. 遍历排序后的数组，对于每个数字，检查它是否可以作为某个连续子数组的起始点。
4. 如果可以，则从哈希表中减去该连续子数组中的所有数字的计数。
5. 如果在任何时候无法找到足够的连续数字，则返回 False。
6. 如果遍历完整个数组后没有问题，则返回 True。

关键点:
- 使用哈希表来记录每个数字的出现次数。
- 每次找到一个连续子数组时，更新哈希表中的计数。
- 确保每次选择的起始点是当前最小且未被使用过的数字。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log n)，其中 n 是 nums 的长度。排序操作的时间复杂度是 O(n log n)，后续遍历操作是 O(n)。
空间复杂度: O(n)，哈希表的空间复杂度是 O(n)。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List
from leetcode_solutions.utils.solution import create_solution


def can_divide_array(nums: List[int], k: int) -> bool:
    """
    判断是否可以把数组划分成一些由 k 个连续数字组成的集合。
    """
    if len(nums) % k != 0:
        return False
    
    count = {}
    for num in nums:
        if num in count:
            count[num] += 1
        else:
            count[num] = 1
    
    nums.sort()
    
    for num in nums:
        if count[num] == 0:
            continue
        for i in range(k):
            if count.get(num + i, 0) < count[num]:
                return False
            count[num + i] -= count[num]
    
    return True


Solution = create_solution(can_divide_array)