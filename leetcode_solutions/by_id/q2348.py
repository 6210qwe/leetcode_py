# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2348
标题: Count Number of Texts
难度: medium
链接: https://leetcode.cn/problems/count-number-of-texts/
题目类型: 哈希表、数学、字符串、动态规划
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2266. 统计打字方案数 - Alice 在给 Bob 用手机打字。数字到字母的 对应 如下图所示。 [https://pic.leetcode.cn/1722224025-gsUAIv-image.png] 为了 打出 一个字母，Alice 需要 按 对应字母 i 次，i 是该字母在这个按键上所处的位置。 * 比方说，为了按出字母 's' ，Alice 需要按 '7' 四次。类似的， Alice 需要按 '5' 两次得到字母 'k' 。 * 注意，数字 '0' 和 '1' 不映射到任何字母，所以 Alice 不 使用它们。 但是，由于传输的错误，Bob 没有收到 Alice 打字的字母信息，反而收到了 按键的字符串信息 。 * 比方说，Alice 发出的信息为 "bob" ，Bob 将收到字符串 "2266622" 。 给你一个字符串 pressedKeys ，表示 Bob 收到的字符串，请你返回 Alice 总共可能发出多少种文字信息 。 由于答案可能很大，将它对 109 + 7 取余 后返回。 示例 1： 输入：pressedKeys = "22233" 输出：8 解释： Alice 可能发出的文字信息包括： "aaadd", "abdd", "badd", "cdd", "aaae", "abe", "bae" 和 "ce" 。 由于总共有 8 种可能的信息，所以我们返回 8 。 示例 2： 输入：pressedKeys = "222222222222222222222222222222222222" 输出：82876089 解释： 总共有 2082876103 种 Alice 可能发出的文字信息。 由于我们需要将答案对 109 + 7 取余，所以我们返回 2082876103 % (109 + 7) = 82876089 。 提示： * 1 <= pressedKeys.length <= 105 * pressedKeys 只包含数字 '2' 到 '9' 。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 动态规划

算法步骤:
1. 初始化一个长度为 n+1 的 dp 数组，dp[i] 表示前 i 个按键的所有可能组合数。
2. 设置 dp[0] = 1，表示空字符串有一种组合方式。
3. 遍历每个按键，根据当前按键的字符和之前的按键字符来更新 dp 数组。
4. 如果当前按键与前一个按键相同，则可以考虑连续按多次的情况。
5. 最后返回 dp[n] 即为结果。

关键点:
- 使用动态规划来记录每一步的组合数。
- 考虑按键连续按多次的情况。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)
空间复杂度: O(n)
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def count_texts(pressed_keys: str) -> int:
    MOD = 10**9 + 7
    n = len(pressed_keys)
    dp = [0] * (n + 1)
    dp[0] = 1  # 空字符串有一种组合方式

    for i in range(1, n + 1):
        dp[i] = dp[i - 1]  # 按一次
        if i > 1 and pressed_keys[i - 1] == pressed_keys[i - 2]:
            dp[i] += dp[i - 2]  # 按两次
            if i > 2 and pressed_keys[i - 1] == pressed_keys[i - 3]:
                dp[i] += dp[i - 3]  # 按三次
                if i > 3 and pressed_keys[i - 1] in '79' and pressed_keys[i - 1] == pressed_keys[i - 4]:
                    dp[i] += dp[i - 4]  # 按四次
        dp[i] %= MOD

    return dp[n]


Solution = create_solution(count_texts)