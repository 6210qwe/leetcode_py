# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1808
标题: Stone Game VII
难度: medium
链接: https://leetcode.cn/problems/stone-game-vii/
题目类型: 数组、数学、动态规划、博弈
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1690. 石子游戏 VII - 石子游戏中，爱丽丝和鲍勃轮流进行自己的回合，爱丽丝先开始 。 有 n 块石子排成一排。每个玩家的回合中，可以从行中 移除 最左边的石头或最右边的石头，并获得与该行中剩余石头值之 和 相等的得分。当没有石头可移除时，得分较高者获胜。 鲍勃发现他总是输掉游戏（可怜的鲍勃，他总是输），所以他决定尽力 减小得分的差值 。爱丽丝的目标是最大限度地 扩大得分的差值 。 给你一个整数数组 stones ，其中 stones[i] 表示 从左边开始 的第 i 个石头的值，如果爱丽丝和鲍勃都 发挥出最佳水平 ，请返回他们 得分的差值 。 示例 1： 输入：stones = [5,3,1,4,2] 输出：6 解释： - 爱丽丝移除 2 ，得分 5 + 3 + 1 + 4 = 13 。游戏情况：爱丽丝 = 13 ，鲍勃 = 0 ，石子 = [5,3,1,4] 。 - 鲍勃移除 5 ，得分 3 + 1 + 4 = 8 。游戏情况：爱丽丝 = 13 ，鲍勃 = 8 ，石子 = [3,1,4] 。 - 爱丽丝移除 3 ，得分 1 + 4 = 5 。游戏情况：爱丽丝 = 18 ，鲍勃 = 8 ，石子 = [1,4] 。 - 鲍勃移除 1 ，得分 4 。游戏情况：爱丽丝 = 18 ，鲍勃 = 12 ，石子 = [4] 。 - 爱丽丝移除 4 ，得分 0 。游戏情况：爱丽丝 = 18 ，鲍勃 = 12 ，石子 = [] 。 得分的差值 18 - 12 = 6 。 示例 2： 输入：stones = [7,90,5,1,100,10,10,2] 输出：122 提示： * n == stones.length * 2 <= n <= 1000 * 1 <= stones[i] <= 1000
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用动态规划来解决这个问题。定义 dp[i][j] 表示在区间 [i, j] 内，当前玩家与对手的最大得分差值。

算法步骤:
1. 初始化一个二维数组 dp，其中 dp[i][j] 表示在区间 [i, j] 内，当前玩家与对手的最大得分差值。
2. 计算前缀和数组 prefix_sum，prefix_sum[i] 表示从 stones[0] 到 stones[i-1] 的和。
3. 从后往前遍历区间长度，更新 dp 数组。
4. 返回 dp[0][n-1]，即整个区间的最大得分差值。

关键点:
- 使用前缀和数组来快速计算区间和。
- 动态规划的状态转移方程为：
  dp[i][j] = max(prefix_sum[j+1] - prefix_sum[i+1] - dp[i+1][j], prefix_sum[j] - prefix_sum[i] - dp[i][j-1])
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n^2)，其中 n 是 stones 的长度。需要遍历所有可能的区间。
空间复杂度: O(n^2)，用于存储 dp 数组。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def stoneGameVII(stones: List[int]) -> int:
    n = len(stones)
    prefix_sum = [0] * (n + 1)
    for i in range(n):
        prefix_sum[i + 1] = prefix_sum[i] + stones[i]
    
    dp = [[0] * n for _ in range(n)]
    
    for length in range(2, n + 1):
        for i in range(n - length + 1):
            j = i + length - 1
            dp[i][j] = max(
                prefix_sum[j + 1] - prefix_sum[i + 1] - dp[i + 1][j],
                prefix_sum[j] - prefix_sum[i] - dp[i][j - 1]
            )
    
    return dp[0][n - 1]

Solution = create_solution(stoneGameVII)