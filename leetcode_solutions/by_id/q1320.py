# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1320
标题: Remove All Adjacent Duplicates in String II
难度: medium
链接: https://leetcode.cn/problems/remove-all-adjacent-duplicates-in-string-ii/
题目类型: 栈、字符串
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1209. 删除字符串中的所有相邻重复项 II - 给你一个字符串 s，「k 倍重复项删除操作」将会从 s 中选择 k 个相邻且相等的字母，并删除它们，使被删去的字符串的左侧和右侧连在一起。 你需要对 s 重复进行无限次这样的删除操作，直到无法继续为止。 在执行完所有删除操作后，返回最终得到的字符串。 本题答案保证唯一。 示例 1： 输入：s = "abcd", k = 2 输出："abcd" 解释：没有要删除的内容。 示例 2： 输入：s = "deeedbbcccbdaa", k = 3 输出："aa" 解释： 先删除 "eee" 和 "ccc"，得到 "ddbbbdaa" 再删除 "bbb"，得到 "dddaa" 最后删除 "ddd"，得到 "aa" 示例 3： 输入：s = "pbbcggttciiippooaais", k = 2 输出："ps" 提示： * 1 <= s.length <= 10^5 * 2 <= k <= 10^4 * s 中只含有小写英文字母。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用栈来记录字符及其连续出现的次数，当某个字符的连续出现次数达到 k 时，将其从栈中移除。

算法步骤:
1. 初始化一个空栈，用于存储字符及其连续出现的次数。
2. 遍历字符串 s 中的每个字符：
   - 如果栈顶元素的字符与当前字符相同，则增加栈顶元素的计数。
   - 否则，将当前字符及其计数 1 压入栈中。
3. 每次压入栈后，检查栈顶元素的计数是否达到 k，如果达到，则将其从栈中弹出。
4. 最后，将栈中的字符拼接成结果字符串并返回。

关键点:
- 使用栈来记录字符及其连续出现的次数，可以有效地处理连续重复字符的删除。
- 每次压入栈后立即检查栈顶元素的计数，确保及时删除符合条件的字符。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)，其中 n 是字符串 s 的长度。每个字符最多只会被压入和弹出栈一次。
空间复杂度: O(n)，在最坏情况下，栈中可能存储所有的字符及其计数。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def remove_duplicates(s: str, k: int) -> str:
    """
    函数式接口 - 删除字符串中的所有相邻重复项 II
    """
    stack = []  # 栈用于存储字符及其连续出现的次数

    for char in s:
        if stack and stack[-1][0] == char:
            stack[-1][1] += 1
            if stack[-1][1] == k:
                stack.pop()
        else:
            stack.append([char, 1])

    result = ''.join(char * count for char, count in stack)
    return result


Solution = create_solution(remove_duplicates)