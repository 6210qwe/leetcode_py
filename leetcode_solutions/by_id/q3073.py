# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 3073
标题: Reshape Data: Melt
难度: easy
链接: https://leetcode.cn/problems/reshape-data-melt/
题目类型: 其他
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2890. 重塑数据：融合 - DataFrame report +-------------+--------+ | Column Name | Type | +-------------+--------+ | product | object | | quarter_1 | int | | quarter_2 | int | | quarter_3 | int | | quarter_4 | int | +-------------+--------+ 编写一个解决方案，将数据 重塑 成每一行表示特定季度产品销售数据的形式。 结果格式如下例所示： 示例 1： 输入： +-------------+-----------+-----------+-----------+-----------+ | product | quarter_1 | quarter_2 | quarter_3 | quarter_4 | +-------------+-----------+-----------+-----------+-----------+ | Umbrella | 417 | 224 | 379 | 611 | | SleepingBag | 800 | 936 | 93 | 875 | +-------------+-----------+-----------+-----------+-----------+ 输出： +-------------+-----------+-------+ | product | quarter | sales | +-------------+-----------+-------+ | Umbrella | quarter_1 | 417 | | SleepingBag | quarter_1 | 800 | | Umbrella | quarter_2 | 224 | | SleepingBag | quarter_2 | 936 | | Umbrella | quarter_3 | 379 | | SleepingBag | quarter_3 | 93 | | Umbrella | quarter_4 | 611 | | SleepingBag | quarter_4 | 875 | +-------------+-----------+-------+ 解释： DataFrame 已从宽格式重塑为长格式。每一行表示一个季度内产品的销售情况。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用 pandas 的 melt 函数将宽格式的数据重塑为长格式。

算法步骤:
1. 使用 pandas 的 melt 函数将数据从宽格式转换为长格式。
2. 设置 id_vars 参数为 'product'，value_vars 参数为各个季度的列名。
3. 将生成的长格式 DataFrame 返回。

关键点:
- 使用 pandas 库中的 melt 函数进行数据重塑。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)，其中 n 是 DataFrame 中的元素总数。
空间复杂度: O(n)，生成的长格式 DataFrame 所需的空间。
"""

# ============================================================================
# 代码实现
# ============================================================================

import pandas as pd

def reshape_data_melt(report: pd.DataFrame) -> pd.DataFrame:
    """
    将宽格式的数据重塑为长格式。
    
    :param report: 宽格式的 DataFrame
    :return: 长格式的 DataFrame
    """
    # 使用 melt 函数将数据从宽格式转换为长格式
    melted_report = pd.melt(report, id_vars=['product'], 
                             value_vars=['quarter_1', 'quarter_2', 'quarter_3', 'quarter_4'],
                             var_name='quarter', value_name='sales')
    return melted_report

Solution = create_solution(reshape_data_melt)