# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 3760
标题: Assign Elements to Groups with Constraints
难度: medium
链接: https://leetcode.cn/problems/assign-elements-to-groups-with-constraints/
题目类型: 数组、哈希表
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
3447. 将元素分配给有约束条件的组 - 给你一个整数数组 groups，其中 groups[i] 表示第 i 组的大小。另给你一个整数数组 elements。 请你根据以下规则为每个组分配 一个 元素： * 如果 groups[i] 能被 elements[j] 整除，则下标为 j 的元素可以分配给组 i。 * 如果有多个元素满足条件，则分配 最小的下标 j 的元素。 * 如果没有元素满足条件，则分配 -1 。 返回一个整数数组 assigned，其中 assigned[i] 是分配给组 i 的元素的索引，若无合适的元素，则为 -1。 注意：一个元素可以分配给多个组。 示例 1： 输入： groups = [8,4,3,2,4], elements = [4,2] 输出： [0,0,-1,1,0] 解释： * elements[0] = 4 被分配给组 0、1 和 4。 * elements[1] = 2 被分配给组 3。 * 无法为组 2 分配任何元素，分配 -1 。 示例 2： 输入： groups = [2,3,5,7], elements = [5,3,3] 输出： [-1,1,0,-1] 解释： * elements[1] = 3 被分配给组 1。 * elements[0] = 5 被分配给组 2。 * 无法为组 0 和组 3 分配任何元素，分配 -1 。 示例 3： 输入： groups = [10,21,30,41], elements = [2,1] 输出： [0,1,0,1] 解释： elements[0] = 2 被分配给所有偶数值的组，而 elements[1] = 1 被分配给所有奇数值的组。 提示： * 1 <= groups.length <= 105 * 1 <= elements.length <= 105 * 1 <= groups[i] <= 105 * 1 <= elements[i] <= 105
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用哈希表记录每个元素的最小下标，然后遍历每个组，找到符合条件的最小下标的元素。

算法步骤:
1. 创建一个哈希表，记录每个元素的最小下标。
2. 遍历每个组，检查每个元素是否能整除该组的大小，如果能则记录该元素的下标。
3. 如果有多个元素满足条件，选择最小下标的元素。
4. 如果没有元素满足条件，分配 -1。

关键点:
- 使用哈希表记录每个元素的最小下标，避免重复计算。
- 通过遍历每个组，找到符合条件的最小下标的元素。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n + m)，其中 n 是 groups 的长度，m 是 elements 的长度。
空间复杂度: O(m)，用于存储每个元素的最小下标。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def assign_elements_to_groups(groups: List[int], elements: List[int]) -> List[int]:
    # 记录每个元素的最小下标
    element_indices = {element: index for index, element in enumerate(elements)}
    
    # 初始化结果数组
    assigned = [-1] * len(groups)
    
    # 遍历每个组，找到符合条件的最小下标的元素
    for i, group in enumerate(groups):
        for element in elements:
            if group % element == 0:
                if assigned[i] == -1 or element_indices[element] < element_indices[elements[assigned[i]]]:
                    assigned[i] = element_indices[element]
    
    return assigned

Solution = create_solution(assign_elements_to_groups)