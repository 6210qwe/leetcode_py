# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 878
标题: Shifting Letters
难度: medium
链接: https://leetcode.cn/problems/shifting-letters/
题目类型: 数组、字符串、前缀和
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
848. 字母移位 - 有一个由小写字母组成的字符串 s，和一个长度相同的整数数组 shifts。 我们将字母表中的下一个字母称为原字母的 移位 shift() （由于字母表是环绕的， 'z' 将会变成 'a'）。 * 例如，shift('a') = 'b', shift('t') = 'u', 以及 shift('z') = 'a'。 对于每个 shifts[i] = x ， 我们会将 s 中的前 i + 1 个字母移位 x 次。 返回 将所有这些移位都应用到 s 后最终得到的字符串 。 示例 1： 输入：s = "abc", shifts = [3,5,9] 输出："rpl" 解释： 我们以 "abc" 开始。 将 S 中的第 1 个字母移位 3 次后，我们得到 "dbc"。 再将 S 中的前 2 个字母移位 5 次后，我们得到 "igc"。 最后将 S 中的这 3 个字母移位 9 次后，我们得到答案 "rpl"。 示例 2: 输入: s = "aaa", shifts = [1,2,3] 输出: "gfd" 提示: * 1 <= s.length <= 105 * s 由小写英文字母组成 * shifts.length == s.length * 0 <= shifts[i] <= 109
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用前缀和从后向前计算每个字符的总移位次数，然后逐个字符进行移位。

算法步骤:
1. 计算从后向前的前缀和，这样可以避免重复计算。
2. 从后向前遍历字符串，根据前缀和计算每个字符的最终移位次数。
3. 对每个字符进行移位操作，并构建结果字符串。

关键点:
- 使用前缀和优化移位次数的计算。
- 从后向前遍历字符串，避免重复移位。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)
空间复杂度: O(1)（不考虑输入输出）
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def shiftingLetters(s: str, shifts: List[int]) -> str:
    """
    函数式接口 - 实现字母移位
    """
    # 计算从后向前的前缀和
    total_shift = 0
    for i in range(len(shifts) - 1, -1, -1):
        total_shift += shifts[i]
        shifts[i] = total_shift % 26
    
    # 从后向前遍历字符串，进行移位操作
    result = []
    for i in range(len(s)):
        char = s[i]
        shifted_char = chr((ord(char) - ord('a') + shifts[i]) % 26 + ord('a'))
        result.append(shifted_char)
    
    return ''.join(result)

Solution = shiftingLetters