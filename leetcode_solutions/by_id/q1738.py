# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1738
标题: Maximal Network Rank
难度: medium
链接: https://leetcode.cn/problems/maximal-network-rank/
题目类型: 图
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1615. 最大网络秩 - n 座城市和一些连接这些城市的道路 roads 共同组成一个基础设施网络。每个 roads[i] = [ai, bi] 都表示在城市 ai 和 bi 之间有一条双向道路。 两座不同城市构成的 城市对 的 网络秩 定义为：与这两座城市 直接 相连的道路总数。如果存在一条道路直接连接这两座城市，则这条道路只计算 一次 。 整个基础设施网络的 最大网络秩 是所有不同城市对中的 最大网络秩 。 给你整数 n 和数组 roads，返回整个基础设施网络的 最大网络秩 。 示例 1： [https://assets.leetcode.cn/aliyun-lc-upload/uploads/2020/10/11/ex1.png] 输入：n = 4, roads = [[0,1],[0,3],[1,2],[1,3]] 输出：4 解释：城市 0 和 1 的网络秩是 4，因为共有 4 条道路与城市 0 或 1 相连。位于 0 和 1 之间的道路只计算一次。 示例 2： [https://assets.leetcode.cn/aliyun-lc-upload/uploads/2020/10/11/ex2.png] 输入：n = 5, roads = [[0,1],[0,3],[1,2],[1,3],[2,3],[2,4]] 输出：5 解释：共有 5 条道路与城市 1 或 2 相连。 示例 3： 输入：n = 8, roads = [[0,1],[1,2],[2,3],[2,4],[5,6],[5,7]] 输出：5 解释：2 和 5 的网络秩为 5，注意并非所有的城市都需要连接起来。 提示： * 2 <= n <= 100 * 0 <= roads.length <= n * (n - 1) / 2 * roads[i].length == 2 * 0 <= ai, bi <= n-1 * ai != bi * 每对城市之间 最多只有一条 道路相连
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用邻接表来记录每个城市的连接情况，并通过遍历所有城市对来计算最大网络秩。

算法步骤:
1. 构建邻接表来记录每个城市的连接情况。
2. 计算每个城市的度（即直接相连的道路数）。
3. 遍历所有城市对，计算其网络秩，并更新最大网络秩。

关键点:
- 使用邻接表可以高效地记录和查询每个城市的连接情况。
- 通过遍历所有城市对来确保找到最大网络秩。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n^2)，其中 n 是城市的数量。我们需要遍历所有城市对来计算网络秩。
空间复杂度: O(n + m)，其中 n 是城市的数量，m 是道路的数量。邻接表的空间复杂度为 O(n + m)。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def maximalNetworkRank(n: int, roads: List[List[int]]) -> int:
    """
    计算基础设施网络的最大网络秩。
    
    :param n: 城市的数量
    :param roads: 连接城市的道路列表
    :return: 最大网络秩
    """
    # 构建邻接表
    adj_list = [set() for _ in range(n)]
    for a, b in roads:
        adj_list[a].add(b)
        adj_list[b].add(a)
    
    # 计算每个城市的度
    degrees = [len(adj_list[i]) for i in range(n)]
    
    # 初始化最大网络秩
    max_rank = 0
    
    # 遍历所有城市对
    for i in range(n):
        for j in range(i + 1, n):
            rank = degrees[i] + degrees[j]
            if j in adj_list[i]:
                rank -= 1
            max_rank = max(max_rank, rank)
    
    return max_rank

Solution = create_solution(maximalNetworkRank)