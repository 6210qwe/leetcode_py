# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 8
标题: String to Integer (atoi)
难度: medium
链接: https://leetcode.cn/problems/string-to-integer-atoi/
题目类型: 字符串
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
8. 字符串转换整数 (atoi) - 请你来实现一个 myAtoi(string s) 函数，使其能将字符串转换成一个 32 位有符号整数。 函数 myAtoi(string s) 的算法如下： 1. 空格：读入字符串并丢弃无用的前导空格（" "） 2. 符号：检查下一个字符（假设还未到字符末尾）为 '-' 还是 '+'。如果两者都不存在，则假定结果为正。 3. 转换：通过跳过前置零来读取该整数，直到遇到非数字字符或到达字符串的结尾。如果没有读取数字，则结果为0。 4. 舍入：如果整数数超过 32 位有符号整数范围 [−231, 231 − 1] ，需要截断这个整数，使其保持在这个范围内。具体来说，小于 −231 的整数应该被舍入为 −231 ，大于 231 − 1 的整数应该被舍入为 231 − 1 。 返回整数作为最终结果。 示例 1： 输入：s = "42" 输出：42 解释：加粗的字符串为已经读入的字符，插入符号是当前读取的字符。 带下划线线的字符是所读的内容，插入符号是当前读入位置。 第 1 步："42"（当前没有读入字符，因为没有前导空格） ^ 第 2 步："42"（当前没有读入字符，因为这里不存在 '-' 或者 '+'） ^ 第 3 步："42"（读入 "42"） ^ 示例 2： 输入：s = " -042" 输出：-42 解释： 第 1 步：" -042"（读入前导空格，但忽视掉） ^ 第 2 步：" -042"（读入 '-' 字符，所以结果应该是负数） ^ 第 3 步：" -042"（读入 "042"，在结果中忽略前导零） ^ 示例 3： 输入：s = "1337c0d3" 输出：1337 解释： 第 1 步："1337c0d3"（当前没有读入字符，因为没有前导空格） ^ 第 2 步："1337c0d3"（当前没有读入字符，因为这里不存在 '-' 或者 '+'） ^ 第 3 步："1337c0d3"（读入 "1337"；由于下一个字符不是一个数字，所以读入停止） ^ 示例 4： 输入：s = "0-1" 输出：0 解释： 第 1 步："0-1" (当前没有读入字符，因为没有前导空格) ^ 第 2 步："0-1" (当前没有读入字符，因为这里不存在 '-' 或者 '+') ^ 第 3 步："0-1" (读入 "0"；由于下一个字符不是一个数字，所以读入停止) ^ 示例 5： 输入：s = "words and 987" 输出：0 解释： 读取在第一个非数字字符“w”处停止。 提示： * 0 <= s.length <= 200 * s 由英文字母（大写和小写）、数字（0-9）、' '、'+'、'-' 和 '.' 组成
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 状态机方法，按照题目要求逐步处理字符串

算法步骤:
1. 跳过前导空格
2. 读取符号（如果有）
3. 读取数字，直到遇到非数字字符或字符串结束
4. 在读取过程中检查溢出，如果溢出则返回边界值
5. 返回结果

关键点:
- 使用状态机思想，清晰处理各种情况
- 需要在读取过程中检查溢出，避免使用64位整数
- 前导零在读取时自动忽略（因为不影响数值）
- 如果第一个非空格字符不是数字或符号，返回0
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n) - 只需遍历字符串一次，n为字符串长度
空间复杂度: O(1) - 只使用常数额外空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def my_atoi(s: str) -> int:
    """
    函数式接口 - 状态机实现
    
    实现思路:
    按照题目要求逐步处理字符串：跳过空格、读取符号、读取数字，并在过程中检查溢出。
    
    Args:
        s: 输入字符串
        
    Returns:
        转换后的32位有符号整数，溢出则返回边界值
        
    Example:
        >>> my_atoi("42")
        42
        >>> my_atoi(" -042")
        -42
        >>> my_atoi("1337c0d3")
        1337
    """
    if not s:
        return 0
    
    INT_MAX = 2**31 - 1
    INT_MIN = -2**31
    
    # 跳过前导空格
    i = 0
    while i < len(s) and s[i] == ' ':
        i += 1
    
    if i >= len(s):
        return 0
    
    # 读取符号
    sign = 1
    if s[i] == '-':
        sign = -1
        i += 1
    elif s[i] == '+':
        i += 1
    
    # 读取数字
    result = 0
    while i < len(s) and s[i].isdigit():
        digit = int(s[i])
        # 检查溢出
        if result > INT_MAX // 10 or (result == INT_MAX // 10 and digit > 7):
            return INT_MAX if sign == 1 else INT_MIN
        result = result * 10 + digit
        i += 1
    
    return sign * result


# 自动生成Solution类（无需手动编写）
Solution = create_solution(my_atoi)
