# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 201
标题: Bitwise AND of Numbers Range
难度: medium
链接: https://leetcode.cn/problems/bitwise-and-of-numbers-range/
题目类型: 位运算
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
201. 数字范围按位与 - 给你两个整数 left 和 right ，表示区间 [left, right] ，返回此区间内所有数字 按位与 的结果（包含 left 、right 端点）。 示例 1： 输入：left = 5, right = 7 输出：4 示例 2： 输入：left = 0, right = 0 输出：0 示例 3： 输入：left = 1, right = 2147483647 输出：0 提示： * 0 <= left <= right <= 231 - 1
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 找到left和right的公共前缀，公共前缀后的位都会变为0

算法步骤:
1. 右移left和right，直到它们相等
2. 记录右移的次数
3. 将结果左移相同的次数

关键点:
- 找到公共前缀
- 时间复杂度O(log n)，空间复杂度O(1)
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(log n) - n为right的值
空间复杂度: O(1) - 只使用常数额外空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def bitwise_and_of_numbers_range(left: int, right: int) -> int:
    """
    函数式接口 - 数字范围按位与
    
    实现思路:
    找到left和right的公共前缀，公共前缀后的位都会变为0。
    
    Args:
        left: 区间左端点
        right: 区间右端点
        
    Returns:
        区间内所有数字按位与的结果
        
    Example:
        >>> bitwise_and_of_numbers_range(5, 7)
        4
    """
    shift = 0
    
    while left < right:
        left >>= 1
        right >>= 1
        shift += 1
    
    return left << shift


# 自动生成Solution类（无需手动编写）
Solution = create_solution(bitwise_and_of_numbers_range)
