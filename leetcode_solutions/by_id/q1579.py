# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1579
标题: Active Users
难度: medium
链接: https://leetcode.cn/problems/active-users/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1454. 活跃用户 - 备战技术面试？力扣提供海量技术面试资源，帮助你高效提升编程技能,轻松拿下世界 IT 名企 Dream Offer。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用Pandas进行数据处理和过滤

算法步骤:
1. 读取输入的DataFrame
2. 过滤出活动日期在给定范围内的记录
3. 去重并统计活跃用户数量

关键点:
- 使用Pandas的时间范围过滤功能
- 使用groupby和nunique来统计活跃用户数量
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)
空间复杂度: O(n)
"""

# ============================================================================
# 代码实现
# ============================================================================

import pandas as pd


def count_active_users(logs: pd.DataFrame, start_date: str, end_date: str) -> pd.DataFrame:
    """
    函数式接口 - 统计指定日期范围内的活跃用户数量
    """
    # 过滤出活动日期在给定范围内的记录
    filtered_logs = logs[(logs['activity_date'] >= start_date) & (logs['activity_date'] <= end_date)]
    
    # 去重并统计活跃用户数量
    active_users = filtered_logs.groupby('user_id')['activity_date'].nunique().reset_index()
    
    # 返回结果
    result = pd.DataFrame({'total': [len(active_users)]})
    return result


Solution = create_solution(count_active_users)