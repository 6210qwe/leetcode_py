# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2222
标题: Abbreviating the Product of a Range
难度: hard
链接: https://leetcode.cn/problems/abbreviating-the-product-of-a-range/
题目类型: 数学
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2117. 一个区间内所有数乘积的缩写 - 给你两个正整数 left 和 right ，满足 left <= right 。请你计算 闭区间 [left, right] 中所有整数的 乘积 。 由于乘积可能非常大，你需要将它按照以下步骤 缩写 ： 1. 统计乘积中 后缀 0 的数目，并 移除 这些 0 ，将这个数目记为 C 。 * 比方说，1000 中有 3 个后缀 0 ，546 中没有后缀 0 。 2. 将乘积中剩余数字的位数记为 d 。如果 d > 10 ，那么将乘积表示为 <pre>...<suf> 的形式，其中 <pre> 表示乘积最 开始 的 5 个数位，<suf> 表示删除后缀 0 之后 结尾的 5 个数位。如果 d <= 10 ，我们不对它做修改。 * 比方说，我们将 1234567654321 表示为 12345...54321 ，但是 1234567 仍然表示为 1234567 。 3. 最后，将乘积表示为 字符串 "<pre>...<suf>eC" 。 * 比方说，12345678987600000 被表示为 "12345...89876e5" 。 请你返回一个字符串，表示 闭区间 [left, right] 中所有整数 乘积 的 缩写 。 示例 1： 输入：left = 1, right = 4 输出："24e0" 解释： 乘积为 1 × 2 × 3 × 4 = 24 。 由于没有后缀 0 ，所以 24 保持不变，缩写的结尾为 "e0" 。 因为乘积的结果是 2 位数，小于 10 ，所欲我们不进一步将它缩写。 所以，最终将乘积表示为 "24e0" 。 示例 2： 输入：left = 2, right = 11 输出："399168e2" 解释：乘积为 39916800 。 有 2 个后缀 0 ，删除后得到 399168 。缩写的结尾为 "e2" 。 删除后缀 0 后是 6 位数，不需要进一步缩写。 所以，最终将乘积表示为 "399168e2" 。 示例 3： 输入：left = 371, right = 375 输出："7219856259e3" 解释：乘积为 7219856259000 。 提示： * 1 <= left <= right <= 104
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 通过逐个计算区间的乘积并处理后缀0，避免直接计算大数。

算法步骤:
1. 初始化变量来存储乘积和后缀0的数量。
2. 遍历区间内的每个数，更新乘积并统计后缀0的数量。
3. 处理乘积，移除后缀0，并根据位数决定是否进行缩写。
4. 返回最终的缩写结果。

关键点:
- 使用对数来处理大数乘积，避免直接计算导致溢出。
- 逐个处理后缀0，确保结果准确。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)，其中 n 是区间 [left, right] 的长度。
空间复杂度: O(1)，只使用了常数级的额外空间。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def abbreviate_product(left: int, right: int) -> str:
    """
    计算闭区间 [left, right] 中所有整数乘积的缩写。
    """
    product = 1
    num_zeros = 0
    
    for i in range(left, right + 1):
        product *= i
        while product % 10 == 0:
            product //= 10
            num_zeros += 1
    
    product_str = str(product)
    length = len(product_str)
    
    if length <= 10:
        return f"{product_str}e{num_zeros}"
    else:
        prefix = product_str[:5]
        suffix = product_str[-5:]
        return f"{prefix}...{suffix}e{num_zeros}"


Solution = create_solution(abbreviate_product)