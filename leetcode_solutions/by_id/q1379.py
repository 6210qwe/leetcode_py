# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1379
标题: Reconstruct a 2-Row Binary Matrix
难度: medium
链接: https://leetcode.cn/problems/reconstruct-a-2-row-binary-matrix/
题目类型: 贪心、数组、矩阵
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1253. 重构 2 行二进制矩阵 - 给你一个 2 行 n 列的二进制数组： * 矩阵是一个二进制矩阵，这意味着矩阵中的每个元素不是 0 就是 1。 * 第 0 行的元素之和为 upper。 * 第 1 行的元素之和为 lower。 * 第 i 列（从 0 开始编号）的元素之和为 colsum[i]，colsum 是一个长度为 n 的整数数组。 你需要利用 upper，lower 和 colsum 来重构这个矩阵，并以二维整数数组的形式返回它。 如果有多个不同的答案，那么任意一个都可以通过本题。 如果不存在符合要求的答案，就请返回一个空的二维数组。 示例 1： 输入：upper = 2, lower = 1, colsum = [1,1,1] 输出：[[1,1,0],[0,0,1]] 解释：[[1,0,1],[0,1,0]] 和 [[0,1,1],[1,0,0]] 也是正确答案。 示例 2： 输入：upper = 2, lower = 3, colsum = [2,2,1,1] 输出：[] 示例 3： 输入：upper = 5, lower = 5, colsum = [2,1,2,0,1,0,1,2,0,1] 输出：[[1,1,1,0,1,0,0,1,0,0],[1,0,1,0,0,0,1,1,0,1]] 提示： * 1 <= colsum.length <= 10^5 * 0 <= upper, lower <= colsum.length * 0 <= colsum[i] <= 2
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 优先将值为2的列分配给两行，然后将值为1的列分配给剩余的行。

算法步骤:
1. 初始化两个列表 `row1` 和 `row2`，长度与 `colsum` 相同，初始值为0。
2. 遍历 `colsum`，对于每个值：
   - 如果值为2，则将当前列的 `row1` 和 `row2` 设为1，并减少 `upper` 和 `lower`。
   - 如果值为1，则优先将1分配给 `upper` 更大的行，减少相应的 `upper` 或 `lower`。
3. 如果 `upper` 或 `lower` 未减到0，说明无法构造符合条件的矩阵，返回空列表。
4. 返回 `[row1, row2]`。

关键点:
- 优先处理值为2的列，确保两行都分配1。
- 值为1的列根据 `upper` 和 `lower` 的大小进行分配。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)，其中 n 是 `colsum` 的长度。我们只需遍历 `colsum` 一次。
空间复杂度: O(n)，用于存储结果矩阵。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def reconstruct_matrix(upper: int, lower: int, colsum: List[int]) -> List[List[int]]:
    n = len(colsum)
    row1, row2 = [0] * n, [0] * n
    
    for i in range(n):
        if colsum[i] == 2:
            if upper > 0 and lower > 0:
                row1[i], row2[i] = 1, 1
                upper -= 1
                lower -= 1
            else:
                return []
        elif colsum[i] == 1:
            if upper > lower:
                if upper > 0:
                    row1[i] = 1
                    upper -= 1
                else:
                    return []
            else:
                if lower > 0:
                    row2[i] = 1
                    lower -= 1
                else:
                    return []
    
    if upper == 0 and lower == 0:
        return [row1, row2]
    else:
        return []

Solution = create_solution(reconstruct_matrix)