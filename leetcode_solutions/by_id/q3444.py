# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 3444
标题: Find the Number of Good Pairs II
难度: medium
链接: https://leetcode.cn/problems/find-the-number-of-good-pairs-ii/
题目类型: 数组、哈希表
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
3164. 优质数对的总数 II - 给你两个整数数组 nums1 和 nums2，长度分别为 n 和 m。同时给你一个正整数 k。 如果 nums1[i] 可以被 nums2[j] * k 整除，则称数对 (i, j) 为 优质数对（0 <= i <= n - 1, 0 <= j <= m - 1）。 返回 优质数对 的总数。 示例 1： 输入：nums1 = [1,3,4], nums2 = [1,3,4], k = 1 输出：5 解释： 5个优质数对分别是 (0, 0), (1, 0), (1, 1), (2, 0), 和 (2, 2)。 示例 2： 输入：nums1 = [1,2,4,12], nums2 = [2,4], k = 3 输出：2 解释： 2个优质数对分别是 (3, 0) 和 (3, 1)。 提示： * 1 <= n, m <= 105 * 1 <= nums1[i], nums2[j] <= 106 * 1 <= k <= 103
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用哈希表来记录每个数在 nums2 中出现的次数，然后遍历 nums1，对于每个数计算其能被哪些数整除，并累加这些数的出现次数。

算法步骤:
1. 初始化一个哈希表 count，记录 nums2 中每个数的出现次数。
2. 遍历 nums1，对于每个数 num1，计算其能被哪些数整除，并累加这些数的出现次数。
3. 返回累计的优质数对数量。

关键点:
- 使用哈希表来优化查找和计数操作。
- 通过预处理 nums2 来减少重复计算。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n + m)
空间复杂度: O(m)
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def solution_function_name(nums1: List[int], nums2: List[int], k: int) -> int:
    """
    函数式接口 - 计算优质数对的总数
    """
    # 初始化哈希表，记录 nums2 中每个数的出现次数
    count = {}
    for num in nums2:
        if num * k not in count:
            count[num * k] = 0
        count[num * k] += 1

    # 累计优质数对的数量
    good_pairs = 0
    for num in nums1:
        if num in count:
            good_pairs += count[num]

    return good_pairs

Solution = create_solution(solution_function_name)