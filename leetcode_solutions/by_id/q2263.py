# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2263
标题: Maximum Running Time of N Computers
难度: hard
链接: https://leetcode.cn/problems/maximum-running-time-of-n-computers/
题目类型: 贪心、数组、二分查找、排序
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2141. 同时运行 N 台电脑的最长时间 - 你有 n 台电脑。给你整数 n 和一个下标从 0 开始的整数数组 batteries ，其中第 i 个电池可以让一台电脑 运行 batteries[i] 分钟。你想使用这些电池让 全部 n 台电脑 同时 运行。 一开始，你可以给每台电脑连接 至多一个电池 。然后在任意整数时刻，你都可以将一台电脑与它的电池断开连接，并连接另一个电池，你可以进行这个操作 任意次 。新连接的电池可以是一个全新的电池，也可以是别的电脑用过的电池。断开连接和连接新的电池不会花费任何时间。 注意，你不能给电池充电。 请你返回你可以让 n 台电脑同时运行的 最长 分钟数。 示例 1： [https://assets.leetcode.com/uploads/2022/01/06/example1-fit.png] 输入：n = 2, batteries = [3,3,3] 输出：4 解释： 一开始，将第一台电脑与电池 0 连接，第二台电脑与电池 1 连接。 2 分钟后，将第二台电脑与电池 1 断开连接，并连接电池 2 。注意，电池 0 还可以供电 1 分钟。 在第 3 分钟结尾，你需要将第一台电脑与电池 0 断开连接，然后连接电池 1 。 在第 4 分钟结尾，电池 1 也被耗尽，第一台电脑无法继续运行。 我们最多能同时让两台电脑同时运行 4 分钟，所以我们返回 4 。 示例 2： [https://assets.leetcode.com/uploads/2022/01/06/example2.png] 输入：n = 2, batteries = [1,1,1,1] 输出：2 解释： 一开始，将第一台电脑与电池 0 连接，第二台电脑与电池 2 连接。 一分钟后，电池 0 和电池 2 同时耗尽，所以你需要将它们断开连接，并将电池 1 和第一台电脑连接，电池 3 和第二台电脑连接。 1 分钟后，电池 1 和电池 3 也耗尽了，所以两台电脑都无法继续运行。 我们最多能让两台电脑同时运行 2 分钟，所以我们返回 2 。 提示： * 1 <= n <= batteries.length <= 105 * 1 <= batteries[i] <= 109
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用二分查找来确定最大运行时间。我们可以通过二分查找来确定一个可能的最大运行时间，然后检查在这个时间内是否可以满足所有电脑的运行需求。

算法步骤:
1. 对电池数组进行排序。
2. 使用二分查找来确定最大运行时间。
3. 检查当前中间值是否可以满足所有电脑的运行需求。
4. 如果可以，则更新左边界；否则，更新右边界。

关键点:
- 通过二分查找来缩小可能的最大运行时间范围。
- 检查当前中间值是否可以满足所有电脑的运行需求。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log(max(batteries)))，其中 n 是电池的数量，max(batteries) 是电池的最大容量。
空间复杂度: O(1)，只使用了常数级的额外空间。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def max_running_time(n: int, batteries: List[int]) -> int:
    """
    函数式接口 - 返回可以同时运行 n 台电脑的最长时间
    """
    # 对电池数组进行排序
    batteries.sort()
    
    # 计算总电量
    total_power = sum(batteries)
    
    # 二分查找
    left, right = 0, total_power // n
    while left < right:
        mid = (left + right + 1) // 2
        if sum(min(mid, battery) for battery in batteries) >= mid * n:
            left = mid
        else:
            right = mid - 1
    
    return left


Solution = create_solution(max_running_time)