# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1943
标题: Count Pairs of Equal Substrings With Minimum Difference
难度: medium
链接: https://leetcode.cn/problems/count-pairs-of-equal-substrings-with-minimum-difference/
题目类型: 贪心、哈希表、字符串
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1794. 统计距离最小的子串对个数 - 备战技术面试？力扣提供海量技术面试资源，帮助你高效提升编程技能,轻松拿下世界 IT 名企 Dream Offer。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用哈希表记录每个子串的起始位置，并通过滑动窗口找到所有符合条件的子串对。

算法步骤:
1. 初始化一个哈希表 `substrings` 用于存储每个子串的起始位置列表。
2. 使用滑动窗口遍历字符串，生成所有长度为 `k` 的子串，并将其起始位置存入哈希表。
3. 遍历哈希表中的每个子串，计算每对子串之间的距离，并统计最小距离的子串对数量。

关键点:
- 使用哈希表存储子串的起始位置，可以快速查找和比较。
- 通过滑动窗口生成子串，避免重复计算。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n * k)，其中 n 是字符串的长度，k 是子串的长度。
空间复杂度: O(n * k)，哈希表存储所有子串及其起始位置。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def count_equal_substrings(s: str, k: int) -> int:
    """
    函数式接口 - 统计距离最小的子串对个数
    """
    n = len(s)
    substrings = {}
    
    # 生成所有长度为 k 的子串，并将其起始位置存入哈希表
    for i in range(n - k + 1):
        substring = s[i:i + k]
        if substring not in substrings:
            substrings[substring] = []
        substrings[substring].append(i)
    
    min_distance = float('inf')
    pair_count = 0
    
    # 遍历哈希表中的每个子串，计算每对子串之间的距离
    for positions in substrings.values():
        for i in range(len(positions) - 1):
            distance = positions[i + 1] - positions[i]
            if distance < min_distance:
                min_distance = distance
                pair_count = 1
            elif distance == min_distance:
                pair_count += 1
    
    return pair_count

Solution = create_solution(count_equal_substrings)