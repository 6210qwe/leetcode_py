# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1000091
标题: 最小矩形面积
难度: hard
链接: https://leetcode.cn/problems/zui-xiao-ju-xing-mian-ji/
题目类型: 贪心、几何、数组、数学、组合数学、排序
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
LCP 37. 最小矩形面积 - 二维平面上有 $N$ 条直线，形式为 `y = kx + b`，其中 `k`、`b`为整数 且 `k > 0`。所有直线以 `[k,b]` 的形式存于二维数组 `lines` 中，不存在重合的两条直线。两两直线之间可能存在一个交点，最多会有 $C_N^2$ 个交点。我们用一个平行于坐标轴的矩形覆盖所有的交点，请问这个矩形最小面积是多少。若直线之间无交点、仅有一个交点或所有交点均在同一条平行坐标轴的直线上，则返回0。 注意：返回结果是浮点数，与标准答案 **绝对误差或相对误差** 在 10^-4 以内的结果都被视为正确结果 **示例 1：** > 输入：`lines = [[2,3],[3,0],[4,1]]` > > 输出：`48.00000` > > 解释：三条直线的三个交点为 (3, 9) (1, 5) 和 (-1, -3)。最小覆盖矩形左下角为 (-1, -3) 右上角为 (3,9)，面积为 48 **示例 2：** > 输入：`lines = [[1,1],[2,3]]` > > 输出：`0.00000` > > 解释：仅有一个交点 (-2，-1） **限制：** + `1 <= lines.length <= 10^5 且 lines[i].length == 2` + `1 <= lines[0] <= 10000` + `-10000 <= lines[1] <= 10000` + `与标准答案绝对误差或相对误差在 10^-4 以内的结果都被视为正确结果`
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 通过计算每对直线的交点，找到所有交点的最小和最大 x 坐标及 y 坐标，从而确定最小矩形的边界。

算法步骤:
1. 计算所有直线的交点。
2. 找到所有交点的最小和最大 x 坐标及 y 坐标。
3. 计算最小矩形的面积。

关键点:
- 使用线性扫描来计算交点。
- 通过维护两个堆来找到最小和最大的 x 坐标及 y 坐标。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log n)
空间复杂度: O(n)
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution
import heapq

def solution_function_name(lines: List[List[int]]) -> float:
    """
    函数式接口 - 计算最小矩形面积
    """
    if len(lines) < 2:
        return 0.0

    # 计算所有直线的交点
    intersections = []
    for i in range(len(lines)):
        for j in range(i + 1, len(lines)):
            k1, b1 = lines[i]
            k2, b2 = lines[j]
            if k1 == k2:
                continue
            x = (b2 - b1) / (k1 - k2)
            y = k1 * x + b1
            intersections.append((x, y))

    if not intersections:
        return 0.0

    # 找到所有交点的最小和最大 x 坐标及 y 坐标
    min_x = min(intersections, key=lambda p: p[0])[0]
    max_x = max(intersections, key=lambda p: p[0])[0]
    min_y = min(intersections, key=lambda p: p[1])[1]
    max_y = max(intersections, key=lambda p: p[1])[1]

    # 计算最小矩形的面积
    width = max_x - min_x
    height = max_y - min_y
    return width * height

Solution = create_solution(solution_function_name)