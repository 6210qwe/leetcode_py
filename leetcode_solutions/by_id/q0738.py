# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 738
标题: Monotone Increasing Digits
难度: medium
链接: https://leetcode.cn/problems/monotone-increasing-digits/
题目类型: 贪心、数学
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
738. 单调递增的数字 - 当且仅当每个相邻位数上的数字 x 和 y 满足 x <= y 时，我们称这个整数是单调递增的。 给定一个整数 n ，返回 小于或等于 n 的最大数字，且数字呈 单调递增 。 示例 1: 输入: n = 10 输出: 9 示例 2: 输入: n = 1234 输出: 1234 示例 3: 输入: n = 332 输出: 299 提示: * 0 <= n <= 109
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 从右到左遍历数字，找到第一个不满足单调递增的位置，然后将该位置减一，并将右侧所有位置设为9。

算法步骤:
1. 将数字转换为字符串形式，方便逐位处理。
2. 从右到左遍历字符串，找到第一个不满足单调递增的位置。
3. 将该位置减一，并将右侧所有位置设为9。
4. 返回处理后的字符串转换为整数。

关键点:
- 从右到左遍历可以确保找到第一个不满足单调递增的位置。
- 将该位置减一并将其右侧所有位置设为9，可以保证结果是小于或等于原数的最大单调递增数。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(d)，其中 d 是数字 n 的位数。
空间复杂度: O(1)，只使用了常数级的额外空间。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def monotone_increasing_digits(n: int) -> int:
    """
    函数式接口 - 返回小于或等于 n 的最大单调递增数字
    """
    # 将数字转换为字符串形式
    s = list(str(n))
    
    # 标记需要调整的位置
    flag = len(s)
    
    # 从右到左遍历字符串
    for i in range(len(s) - 1, 0, -1):
        if s[i] < s[i - 1]:
            # 找到第一个不满足单调递增的位置
            s[i - 1] = str(int(s[i - 1]) - 1)
            flag = i
    
    # 将标记位置之后的所有位置设为9
    for i in range(flag, len(s)):
        s[i] = '9'
    
    # 返回处理后的字符串转换为整数
    return int(''.join(s))


Solution = create_solution(monotone_increasing_digits)