# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 100261
标题: Tic-Tac-Toe LCCI
难度: medium
链接: https://leetcode.cn/problems/tic-tac-toe-lcci/
题目类型: 数组、计数、矩阵
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
面试题 16.04. 井字游戏 - 设计一个算法，判断玩家是否赢了井字游戏。输入是一个 N x N 的数组棋盘，由字符" "，"X"和"O"组成，其中字符" "代表一个空位。 以下是井字游戏的规则： * 玩家轮流将字符放入空位（" "）中。 * 第一个玩家总是放字符"O"，且第二个玩家总是放字符"X"。 * "X"和"O"只允许放置在空位中，不允许对已放有字符的位置进行填充。 * 当有N个相同（且非空）的字符填充任何行、列或对角线时，游戏结束，对应该字符的玩家获胜。 * 当所有位置非空时，也算为游戏结束。 * 如果游戏结束，玩家不允许再放置字符。 如果游戏存在获胜者，就返回该游戏的获胜者使用的字符（"X"或"O"）；如果游戏以平局结束，则返回 "Draw"；如果仍会有行动（游戏未结束），则返回 "Pending"。 示例 1： 输入： board = ["O X"," XO","X O"] 输出： "X" 示例 2： 输入： board = ["OOX","XXO","OXO"] 输出： "Draw" 解释： 没有玩家获胜且不存在空位 示例 3： 输入： board = ["OOX","XXO","OX "] 输出： "Pending" 解释： 没有玩家获胜且仍存在空位 提示： * 1 <= board.length == board[i].length <= 100 * 输入一定遵循井字棋规则
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 通过检查每一行、每一列以及两条对角线来判断是否有玩家获胜。如果没有玩家获胜，检查棋盘上是否有空位来决定是平局还是游戏仍在进行。

算法步骤:
1. 初始化行、列、对角线的计数器。
2. 遍历棋盘，更新行、列、对角线的计数器。
3. 检查每一行、每一列以及两条对角线是否有玩家获胜。
4. 如果没有玩家获胜，检查棋盘上是否有空位来决定是平局还是游戏仍在进行。

关键点:
- 使用计数器来记录每一行、每一列以及两条对角线的状态。
- 通过一次遍历来完成所有检查，时间复杂度为 O(N)。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(N)，其中 N 是棋盘的边长。我们需要遍历整个棋盘一次。
空间复杂度: O(1)，只使用了常数级的额外空间。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def tictactoe(board: List[str]) -> str:
    """
    判断井字游戏的结果。
    :param board: N x N 的棋盘
    :return: 游戏结果，"X" 或 "O" 表示获胜者，"Draw" 表示平局，"Pending" 表示游戏仍在进行
    """
    n = len(board)
    rows, cols = [0] * n, [0] * n
    diagonal, anti_diagonal = 0, 0
    has_empty = False

    for i in range(n):
        for j in range(n):
            if board[i][j] == 'X':
                player = 1
            elif board[i][j] == 'O':
                player = -1
            else:
                has_empty = True
                continue

            rows[i] += player
            cols[j] += player
            if i == j:
                diagonal += player
            if i + j == n - 1:
                anti_diagonal += player

            if abs(rows[i]) == n or abs(cols[j]) == n or abs(diagonal) == n or abs(anti_diagonal) == n:
                return 'X' if player == 1 else 'O'

    if has_empty:
        return "Pending"
    else:
        return "Draw"


Solution = create_solution(tictactoe)