# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1258
标题: Article Views I
难度: easy
链接: https://leetcode.cn/problems/article-views-i/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1148. 文章浏览 I - Views 表： +---------------+---------+ | Column Name | Type | +---------------+---------+ | article_id | int | | author_id | int | | viewer_id | int | | view_date | date | +---------------+---------+ 此表可能会存在重复行。（换句话说，在 SQL 中这个表没有主键） 此表的每一行都表示某人在某天浏览了某位作者的某篇文章。 请注意，同一人的 author_id 和 viewer_id 是相同的。 请查询出所有浏览过自己文章的作者。 结果按照作者的 id 升序排列。 查询结果的格式如下所示： 示例 1： 输入： Views 表： +------------+-----------+-----------+------------+ | article_id | author_id | viewer_id | view_date | +------------+-----------+-----------+------------+ | 1 | 3 | 5 | 2019-08-01 | | 1 | 3 | 6 | 2019-08-02 | | 2 | 7 | 7 | 2019-08-01 | | 2 | 7 | 6 | 2019-08-02 | | 4 | 7 | 1 | 2019-07-22 | | 3 | 4 | 4 | 2019-07-21 | | 3 | 4 | 4 | 2019-07-21 | +------------+-----------+-----------+------------+ 输出： +------+ | id | +------+ | 4 | | 7 | +------+
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用SQL查询来筛选出所有浏览过自己文章的作者，并按作者ID升序排列。

算法步骤:
1. 从Views表中选择author_id和viewer_id相等的记录。
2. 去重这些记录以确保每个作者只出现一次。
3. 按author_id升序排列结果。

关键点:
- 使用DISTINCT去重。
- 使用ORDER BY对结果进行排序。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log n)，其中n是Views表的行数。排序操作的时间复杂度为O(n log n)。
空间复杂度: O(1)，不考虑输出结果的空间占用。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def solution_function_name(params):
    """
    函数式接口 - 查询所有浏览过自己文章的作者，并按作者ID升序排列
    """
    # SQL查询实现
    query = """
    SELECT DISTINCT author_id AS id
    FROM Views
    WHERE author_id = viewer_id
    ORDER BY author_id ASC
    """
    return query


Solution = create_solution(solution_function_name)