# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1129
标题: Longest String Chain
难度: medium
链接: https://leetcode.cn/problems/longest-string-chain/
题目类型: 数组、哈希表、双指针、字符串、动态规划、排序
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1048. 最长字符串链 - 给出一个单词数组 words ，其中每个单词都由小写英文字母组成。 如果我们可以 不改变其他字符的顺序 ，在 wordA 的任何地方添加 恰好一个 字母使其变成 wordB ，那么我们认为 wordA 是 wordB 的 前身 。 * 例如，"abc" 是 "abac" 的 前身 ，而 "cba" 不是 "bcad" 的 前身 词链是单词 [word_1, word_2, ..., word_k] 组成的序列，k >= 1，其中 word1 是 word2 的前身，word2 是 word3 的前身，依此类推。一个单词通常是 k == 1 的 单词链 。 从给定单词列表 words 中选择单词组成词链，返回 词链的 最长可能长度 。 示例 1： 输入：words = ["a","b","ba","bca","bda","bdca"] 输出：4 解释：最长单词链之一为 ["a","ba","bda","bdca"] 示例 2: 输入：words = ["xbc","pcxbcf","xb","cxbc","pcxbc"] 输出：5 解释：所有的单词都可以放入单词链 ["xb", "xbc", "cxbc", "pcxbc", "pcxbcf"]. 示例 3: 输入：words = ["abcd","dbqca"] 输出：1 解释：字链["abcd"]是最长的字链之一。 ["abcd"，"dbqca"]不是一个有效的单词链，因为字母的顺序被改变了。 提示： * 1 <= words.length <= 1000 * 1 <= words[i].length <= 16 * words[i] 仅由小写英文字母组成。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 动态规划 + 哈希表

算法步骤:
1. 将所有单词按长度排序。
2. 使用一个哈希表 dp 来存储每个单词的最长字符串链长度。
3. 对于每个单词，尝试删除其每一个字符，生成新的单词。
4. 在哈希表中查找新生成的单词的最长字符串链长度，并更新当前单词的最长字符串链长度。
5. 最后返回哈希表中的最大值。

关键点:
- 使用哈希表来存储每个单词的最长字符串链长度，避免重复计算。
- 通过删除字符来生成新的单词，从而找到当前单词的前身。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n * m^2)，其中 n 是单词的数量，m 是单词的最大长度。
空间复杂度: O(n)，哈希表的大小与单词数量相同。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def longestStrChain(words: List[str]) -> int:
    """
    函数式接口 - 返回最长字符串链的长度
    """
    # 按单词长度排序
    words.sort(key=len)
    
    # 哈希表存储每个单词的最长字符串链长度
    dp = {}
    
    for word in words:
        dp[word] = 1  # 初始化每个单词的最长字符串链长度为1
        for i in range(len(word)):
            # 生成新的单词
            new_word = word[:i] + word[i+1:]
            if new_word in dp:
                dp[word] = max(dp[word], dp[new_word] + 1)
    
    return max(dp.values())


Solution = create_solution(longestStrChain)