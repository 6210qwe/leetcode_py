# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 196
标题: Delete Duplicate Emails
难度: easy
链接: https://leetcode.cn/problems/delete-duplicate-emails/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
196. 删除重复的电子邮箱 - 表: Person +-------------+---------+ | Column Name | Type | +-------------+---------+ | id | int | | email | varchar | +-------------+---------+ id 是该表的主键列(具有唯一值的列)。 该表的每一行包含一封电子邮件。电子邮件将不包含大写字母。 编写解决方案 删除 所有重复的电子邮件，只保留一个具有最小 id 的唯一电子邮件。 （对于 SQL 用户，请注意你应该编写一个 DELETE 语句而不是 SELECT 语句。） （对于 Pandas 用户，请注意你应该直接修改 Person 表。） 运行脚本后，显示的答案是 Person 表。驱动程序将首先编译并运行您的代码片段，然后再显示 Person 表。Person 表的最终顺序 无关紧要 。 返回结果格式如下示例所示。 示例 1: 输入: Person 表: +----+------------------+ | id | email | +----+------------------+ | 1 | john@example.com | | 2 | bob@example.com | | 3 | john@example.com | +----+------------------+ 输出: +----+------------------+ | id | email | +----+------------------+ | 1 | john@example.com | | 2 | bob@example.com | +----+------------------+ 解释: john@example.com重复两次。我们保留最小的Id = 1。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: SQL DELETE语句，删除重复的邮箱，只保留id最小的

算法步骤:
1. 使用自连接或子查询找出需要删除的记录
2. 删除id不在最小id集合中的记录

关键点:
- 使用DELETE语句删除重复记录
- SQL删除语句
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n^2) - 自连接的时间复杂度
空间复杂度: O(n) - 子查询结果的空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def delete_duplicate_emails():
    """
    函数式接口 - 删除重复的电子邮箱（SQL删除语句）
    
    实现思路:
    使用DELETE语句删除重复的邮箱，只保留id最小的。
    
    Returns:
        SQL删除语句字符串
        
    Example:
        >>> sql = delete_duplicate_emails()
        >>> # 执行SQL删除语句
    """
    sql = """
    DELETE p1 FROM Person p1
    INNER JOIN Person p2
    WHERE p1.email = p2.email AND p1.id > p2.id
    """
    return sql.strip()


# 自动生成Solution类（无需手动编写）
Solution = create_solution(delete_duplicate_emails)
