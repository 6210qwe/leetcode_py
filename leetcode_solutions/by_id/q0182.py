# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 182
标题: Duplicate Emails
难度: easy
链接: https://leetcode.cn/problems/duplicate-emails/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
182. 查找重复的电子邮箱 - 表: Person +-------------+---------+ | Column Name | Type | +-------------+---------+ | id | int | | email | varchar | +-------------+---------+ id 是该表的主键（具有唯一值的列）。 此表的每一行都包含一封电子邮件。电子邮件不包含大写字母。 编写解决方案来报告所有重复的电子邮件。 请注意，可以保证电子邮件字段不为 NULL。 以 任意顺序 返回结果表。 结果格式如下例。 示例 1: 输入: Person 表: +----+---------+ | id | email | +----+---------+ | 1 | a@b.com | | 2 | c@d.com | | 3 | a@b.com | +----+---------+ 输出: +---------+ | Email | +---------+ | a@b.com | +---------+ 解释: a@b.com 出现了两次。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: SQL GROUP BY和HAVING子句查找重复的邮箱

算法步骤:
1. 按email分组
2. 使用HAVING COUNT(*) > 1筛选出现次数大于1的邮箱
3. 返回重复的邮箱

关键点:
- 使用GROUP BY和HAVING查找重复记录
- SQL查询语句
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n) - 需要遍历表一次
空间复杂度: O(n) - 分组结果的空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def duplicate_emails():
    """
    函数式接口 - 查找重复的电子邮箱（SQL查询）
    
    实现思路:
    使用GROUP BY和HAVING子句查找重复的邮箱。
    
    Returns:
        SQL查询语句字符串
        
    Example:
        >>> sql = duplicate_emails()
        >>> # 执行SQL查询
    """
    sql = """
    SELECT email AS Email
    FROM Person
    GROUP BY email
    HAVING COUNT(*) > 1
    """
    return sql.strip()


# 自动生成Solution类（无需手动编写）
Solution = create_solution(duplicate_emails)
