# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 908
标题: Middle of the Linked List
难度: easy
链接: https://leetcode.cn/problems/middle-of-the-linked-list/
题目类型: 链表、双指针
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
876. 链表的中间结点 - 给你单链表的头结点 head ，请你找出并返回链表的中间结点。 如果有两个中间结点，则返回第二个中间结点。 示例 1： [https://assets.leetcode.com/uploads/2021/07/23/lc-midlist1.jpg] 输入：head = [1,2,3,4,5] 输出：[3,4,5] 解释：链表只有一个中间结点，值为 3 。 示例 2： [https://assets.leetcode.com/uploads/2021/07/23/lc-midlist2.jpg] 输入：head = [1,2,3,4,5,6] 输出：[4,5,6] 解释：该链表有两个中间结点，值分别为 3 和 4 ，返回第二个结点。 提示： * 链表的结点数范围是 [1, 100] * 1 <= Node.val <= 100
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用快慢指针找到链表的中间节点

算法步骤:
1. 初始化两个指针 slow 和 fast，都指向链表的头节点。
2. 快指针每次移动两步，慢指针每次移动一步。
3. 当快指针到达链表末尾时，慢指针正好位于链表的中间节点。

关键点:
- 快指针和慢指针的移动速度不同，确保当快指针到达链表末尾时，慢指针正好在中间位置。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)，其中 n 是链表的长度。快指针遍历整个链表一次。
空间复杂度: O(1)，只使用了常数级的额外空间。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.solution import create_solution


def find_middle_node(head: Optional[ListNode]) -> Optional[ListNode]:
    """
    函数式接口 - 找到链表的中间节点
    """
    if not head:
        return None

    slow = fast = head
    while fast and fast.next:
        slow = slow.next
        fast = fast.next.next

    return slow


Solution = create_solution(find_middle_node)