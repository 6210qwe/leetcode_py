# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1175
标题: Array Transformation
难度: easy
链接: https://leetcode.cn/problems/array-transformation/
题目类型: 数组、模拟
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
给定一个整数数组 arr，每次操作可以将 arr 中的每个元素替换为其排名（如果值相同，则排名相同）。返回 arr 在 k 次这样的操作后的结果。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用字典记录每个元素的排名，然后根据排名进行 k 次变换。

算法步骤:
1. 创建一个字典来记录每个元素的排名。
2. 对数组进行排序，并为每个不同的元素分配一个排名。
3. 根据排名对数组进行 k 次变换。

关键点:
- 使用字典记录排名，避免重复计算。
- 每次变换时，直接使用字典中的排名进行替换。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n log n + k * n)，其中 n 是数组的长度。排序的时间复杂度是 O(n log n)，每次变换的时间复杂度是 O(n)。
空间复杂度: O(n)，用于存储排名字典。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def solution_function_name(arr: List[int], k: int) -> List[int]:
    """
    函数式接口 - 实现数组变换
    """
    if not arr or k == 0:
        return arr

    # 记录每个元素的排名
    rank_dict = {}
    sorted_arr = sorted(set(arr))
    for i, val in enumerate(sorted_arr):
        rank_dict[val] = i + 1

    # 进行 k 次变换
    for _ in range(k):
        arr = [rank_dict[x] for x in arr]

    return arr


Solution = create_solution(solution_function_name)