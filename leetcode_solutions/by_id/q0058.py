# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 58
标题: Length of Last Word
难度: easy
链接: https://leetcode.cn/problems/length-of-last-word/
题目类型: 字符串
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
58. 最后一个单词的长度 - 给你一个字符串 s，由若干单词组成，单词前后用一些空格字符隔开。返回字符串中 最后一个 单词的长度。 单词 是指仅由字母组成、不包含任何空格字符的最大子字符串。 示例 1： 输入：s = "Hello World" 输出：5 解释：最后一个单词是“World”，长度为 5。 示例 2： 输入：s = " fly me to the moon " 输出：4 解释：最后一个单词是“moon”，长度为 4。 示例 3： 输入：s = "luffy is still joyboy" 输出：6 解释：最后一个单词是长度为 6 的“joyboy”。 提示： * 1 <= s.length <= 104 * s 仅有英文字母和空格 ' ' 组成 * s 中至少存在一个单词
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 从右向左遍历，跳过尾部空格，然后计算最后一个单词的长度

算法步骤:
1. 从字符串末尾开始，跳过所有尾部空格
2. 从当前位置向左遍历，计算最后一个单词的长度
3. 遇到空格或到达字符串开头时停止

关键点:
- 从右向左遍历，避免处理前导空格
- 时间复杂度O(n)，空间复杂度O(1)
- 也可以使用split()方法，但需要额外空间
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n) - 最坏情况需要遍历整个字符串
空间复杂度: O(1) - 只使用常数额外空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def length_of_last_word(s: str) -> int:
    """
    函数式接口 - 从右向左遍历
    
    实现思路:
    从字符串末尾开始，跳过尾部空格，然后计算最后一个单词的长度。
    
    Args:
        s: 由若干单词组成的字符串，单词前后可能有空格
        
    Returns:
        字符串中最后一个单词的长度
        
    Example:
        >>> length_of_last_word("Hello World")
        5
        >>> length_of_last_word(" fly me to the moon ")
        4
    """
    # 从右向左遍历，跳过尾部空格
    i = len(s) - 1
    while i >= 0 and s[i] == ' ':
        i -= 1
    
    # 计算最后一个单词的长度
    length = 0
    while i >= 0 and s[i] != ' ':
        length += 1
        i -= 1
    
    return length


# 自动生成Solution类（无需手动编写）
Solution = create_solution(length_of_last_word)
