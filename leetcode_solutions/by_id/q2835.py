# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 2835
标题: Split a Circular Linked List
难度: medium
链接: https://leetcode.cn/problems/split-a-circular-linked-list/
题目类型: 链表、双指针
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
2674. 拆分循环链表 - 备战技术面试？力扣提供海量技术面试资源，帮助你高效提升编程技能,轻松拿下世界 IT 名企 Dream Offer。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用快慢指针找到中间节点，然后将循环链表拆分成两个独立的链表。

算法步骤:
1. 初始化两个指针 slow 和 fast，都指向链表的头节点。
2. 快指针每次移动两步，慢指针每次移动一步，当快指针到达链表尾部时，慢指针正好在中间位置。
3. 将慢指针的下一个节点作为第二个链表的头节点，并将慢指针的 next 指向 None，断开第一个链表。
4. 返回两个链表的头节点。

关键点:
- 使用快慢指针可以有效地找到链表的中间节点。
- 断开链表时要注意处理循环链表的特殊性。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)，其中 n 是链表的长度。快慢指针遍历链表一次。
空间复杂度: O(1)，只使用了常数级的额外空间。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.solution import create_solution


def split_circular_linked_list(head: Optional[ListNode]) -> List[Optional[ListNode]]:
    """
    函数式接口 - 拆分循环链表
    """
    if not head or not head.next:
        return [head, None]

    slow = head
    fast = head

    # 使用快慢指针找到中间节点
    while fast.next and fast.next.next:
        slow = slow.next
        fast = fast.next.next

    # 找到第二个链表的头节点
    second_head = slow.next
    # 断开第一个链表
    slow.next = None
    # 如果是循环链表，需要处理 fast 指针
    if fast.next == head:
        fast.next = second_head

    return [head, second_head]


Solution = create_solution(split_circular_linked_list)