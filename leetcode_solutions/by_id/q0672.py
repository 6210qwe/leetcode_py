# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 672
标题: Bulb Switcher II
难度: medium
链接: https://leetcode.cn/problems/bulb-switcher-ii/
题目类型: 位运算、深度优先搜索、广度优先搜索、数学
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
672. 灯泡开关 Ⅱ - 房间中有 n 只已经打开的灯泡，编号从 1 到 n 。墙上挂着 4 个开关 。 这 4 个开关各自都具有不同的功能，其中： * 开关 1 ：反转当前所有灯的状态（即开变为关，关变为开） * 开关 2 ：反转编号为偶数的灯的状态（即 0, 2, 4, ...） * 开关 3 ：反转编号为奇数的灯的状态（即 1, 3, ...） * 开关 4 ：反转编号为 j = 3k + 1 的灯的状态，其中 k = 0, 1, 2, ...（即 1, 4, 7, 10, ...） 你必须 恰好 按压开关 presses 次。每次按压，你都需要从 4 个开关中选出一个来执行按压操作。 给你两个整数 n 和 presses ，执行完所有按压之后，返回 不同可能状态 的数量。 示例 1： 输入：n = 1, presses = 1 输出：2 解释：状态可以是： - 按压开关 1 ，[关] - 按压开关 2 ，[开] 示例 2： 输入：n = 2, presses = 1 输出：3 解释：状态可以是： - 按压开关 1 ，[关, 关] - 按压开关 2 ，[开, 关] - 按压开关 3 ，[关, 开] 示例 3： 输入：n = 3, presses = 1 输出：4 解释：状态可以是： - 按压开关 1 ，[关, 关, 关] - 按压开关 2 ，[开, 关, 开] - 按压开关 3 ，[关, 开, 关] - 按压开关 4 ，[关, 开, 开] 提示： * 1 <= n <= 1000 * 0 <= presses <= 1000
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 分类讨论 + 状态数有限

由于 n 很大，但不同灯泡在 4 个操作下的模式是重复的，实际能区分的灯泡不超过 3 个，
并且 presses 次操作可达的状态数是有限且可枚举的。可以利用已知的分类结论：

1. presses == 0: 只有初始状态 1 种
2. n == 1:
   - presses == 0: 1
   - presses > 0: 2
3. n == 2:
   - presses == 1: 3
   - presses >= 2: 4
4. n >= 3:
   - presses == 1: 4
   - presses == 2: 7
   - presses >= 3: 8

关键点:
- n 超过 3 时，后面的灯泡模式与前 3 个重复
- presses 很大时，状态数达到上限后不再增加
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(1) - 仅进行常数次判断
空间复杂度: O(1)
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def flip_lights(n: int, presses: int) -> int:
    """
    函数式接口 - 灯泡开关 II

    实现思路:
    利用已知分类结论，根据 n 和 presses 返回不同状态数。
    """
    if presses == 0:
        return 1

    if n == 1:
        return 2 if presses > 0 else 1

    if n == 2:
        if presses == 1:
            return 3
        # presses >= 2
        return 4

    # n >= 3
    if presses == 1:
        return 4
    if presses == 2:
        return 7
    return 8


Solution = create_solution(flip_lights)
