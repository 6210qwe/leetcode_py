# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 278
标题: First Bad Version
难度: easy
链接: https://leetcode.cn/problems/first-bad-version/
题目类型: 二分查找、交互
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
278. 第一个错误的版本 - 你是产品经理，目前正在带领一个团队开发新的产品。不幸的是，你的产品的最新版本没有通过质量检测。由于每个版本都是基于之前的版本开发的，所以错误的版本之后的所有版本都是错的。 假设你有 n 个版本 [1, 2, ..., n]，你想找出导致之后所有版本出错的第一个错误的版本。 你可以通过调用 bool isBadVersion(version) 接口来判断版本号 version 是否在单元测试中出错。实现一个函数来查找第一个错误的版本。你应该尽量减少对调用 API 的次数。 示例 1： 输入：n = 5, bad = 4 输出：4 解释： 调用 isBadVersion(3) -> false 调用 isBadVersion(5) -> true 调用 isBadVersion(4) -> true 所以，4 是第一个错误的版本。 示例 2： 输入：n = 1, bad = 1 输出：1 提示： * 1 <= bad <= n <= 231 - 1
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 二分查找，找到第一个bad版本

算法步骤:
1. 使用二分查找
2. 如果mid是bad版本，第一个bad版本在左边
3. 否则在右边

关键点:
- 二分查找
- 时间复杂度O(log n)
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(log n) - 二分查找
空间复杂度: O(1) - 只使用常数额外空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List, Optional
from leetcode_solutions.utils.linked_list import ListNode
from leetcode_solutions.utils.tree import TreeNode
from leetcode_solutions.utils.solution import create_solution


def first_bad_version(n: int, is_bad_version) -> int:
    """
    函数式接口 - 第一个错误的版本
    
    实现思路:
    二分查找：找到第一个bad版本。
    
    Args:
        n: 版本总数
        is_bad_version: 函数is_bad_version(version)返回版本是否错误
        
    Returns:
        第一个错误版本的编号
        
    Example:
        >>> # 示例用法
    """
    left, right = 1, n
    
    while left < right:
        mid = left + (right - left) // 2
        if is_bad_version(mid):
            right = mid
        else:
            left = mid + 1
    
    return left


# 自动生成Solution类（无需手动编写）
Solution = create_solution(first_bad_version)
