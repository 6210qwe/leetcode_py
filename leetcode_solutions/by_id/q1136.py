# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1136
标题: Actors and Directors Who Cooperated At Least Three Times
难度: easy
链接: https://leetcode.cn/problems/actors-and-directors-who-cooperated-at-least-three-times/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1050. 合作过至少三次的演员和导演 - ActorDirector 表： +-------------+---------+ | Column Name | Type | +-------------+---------+ | actor_id | int | | director_id | int | | timestamp | int | +-------------+---------+ timestamp 是这张表的主键(具有唯一值的列). 编写解决方案找出合作过至少三次的演员和导演的 id 对 (actor_id, director_id) 示例 1： 输入： ActorDirector 表： +-------------+-------------+-------------+ | actor_id | director_id | timestamp | +-------------+-------------+-------------+ | 1 | 1 | 0 | | 1 | 1 | 1 | | 1 | 1 | 2 | | 1 | 2 | 3 | | 1 | 2 | 4 | | 2 | 1 | 5 | | 2 | 1 | 6 | +-------------+-------------+-------------+ 输出： +-------------+-------------+ | actor_id | director_id | +-------------+-------------+ | 1 | 1 | +-------------+-------------+ 解释： 唯一的 id 对是 (1, 1)，他们恰好合作了 3 次。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用Pandas库进行数据处理，通过groupby和count方法统计每个演员和导演的合作次数，然后筛选出合作次数大于等于3的组合。

算法步骤:
1. 读取输入数据到Pandas DataFrame。
2. 使用groupby对actor_id和director_id进行分组，并计算每组的行数。
3. 筛选出合作次数大于等于3的组合。
4. 返回结果DataFrame。

关键点:
- 使用Pandas库进行高效的数据处理。
- 通过groupby和count方法统计合作次数。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n)，其中n是ActorDirector表的行数。因为我们需要遍历整个表来进行分组和计数。
空间复杂度: O(n)，因为我们需要存储分组后的结果。
"""

# ============================================================================
# 代码实现
# ============================================================================

import pandas as pd


def solution(actor_director: pd.DataFrame) -> pd.DataFrame:
    """
    函数式接口 - 找出合作过至少三次的演员和导演的id对
    """
    # 使用groupby对actor_id和director_id进行分组，并计算每组的行数
    cooperation_counts = actor_director.groupby(['actor_id', 'director_id']).size().reset_index(name='count')
    
    # 筛选出合作次数大于等于3的组合
    result = cooperation_counts[cooperation_counts['count'] >= 3][['actor_id', 'director_id']]
    
    return result


Solution = create_solution(solution)