# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 1196
标题: Filling Bookcase Shelves
难度: medium
链接: https://leetcode.cn/problems/filling-bookcase-shelves/
题目类型: 数组、动态规划
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
1105. 填充书架 - 给定一个数组 books ，其中 books[i] = [thicknessi, heighti] 表示第 i 本书的厚度和高度。你也会得到一个整数 shelfWidth 。 按顺序 将这些书摆放到总宽度为 shelfWidth 的书架上。 先选几本书放在书架上（它们的厚度之和小于等于书架的宽度 shelfWidth ），然后再建一层书架。重复这个过程，直到把所有的书都放在书架上。 需要注意的是，在上述过程的每个步骤中，摆放书的顺序与给定图书数组 books 顺序相同。 * 例如，如果这里有 5 本书，那么可能的一种摆放情况是：第一和第二本书放在第一层书架上，第三本书放在第二层书架上，第四和第五本书放在最后一层书架上。 每一层所摆放的书的最大高度就是这一层书架的层高，书架整体的高度为各层高之和。 以这种方式布置书架，返回书架整体可能的最小高度。 示例 1： [https://assets.leetcode.com/uploads/2019/06/24/shelves.png] 输入：books = [[1,1],[2,3],[2,3],[1,1],[1,1],[1,1],[1,2]], shelfWidth = 4 输出：6 解释： 3 层书架的高度和为 1 + 3 + 2 = 6 。 第 2 本书不必放在第一层书架上。 示例 2: 输入: books = [[1,3],[2,4],[3,2]], shelfWidth = 6 输出: 4 提示： * 1 <= books.length <= 1000 * 1 <= thicknessi <= shelfWidth <= 1000 * 1 <= heighti <= 1000
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 使用动态规划来解决这个问题。我们定义 dp[i] 为前 i 本书的最小高度。对于每一本书，我们可以选择将其放在当前层或者新的一层。

算法步骤:
1. 初始化 dp 数组，dp[0] = 0。
2. 对于每本书，从后向前遍历，尝试将其放在当前层或新的一层。
3. 更新 dp 数组，记录最小高度。

关键点:
- 动态规划的状态转移方程：dp[i] = min(dp[i], max_height + dp[j])，其中 j 是当前层的最后一本书的索引。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n^2)，其中 n 是 books 的长度。我们需要遍历每本书，并且对于每本书，我们最多需要遍历之前的 n 本书。
空间复杂度: O(n)，用于存储 dp 数组。
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def min_height_shelves(books: List[List[int]], shelf_width: int) -> int:
    n = len(books)
    dp = [float('inf')] * (n + 1)
    dp[0] = 0

    for i in range(1, n + 1):
        max_height, current_width = 0, 0
        j = i - 1
        while j >= 0 and current_width + books[j][0] <= shelf_width:
            current_width += books[j][0]
            max_height = max(max_height, books[j][1])
            dp[i] = min(dp[i], dp[j] + max_height)
            j -= 1

    return dp[n]

Solution = create_solution(min_height_shelves)