# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 180
标题: Consecutive Numbers
难度: medium
链接: https://leetcode.cn/problems/consecutive-numbers/
题目类型: 数据库
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
180. 连续出现的数字 - 表：Logs +-------------+---------+ | Column Name | Type | +-------------+---------+ | id | int | | num | varchar | +-------------+---------+ 在 SQL 中，id 是该表的主键。 id 是一个自增列。 找出所有至少连续出现三次的数字。 返回的结果表中的数据可以按 任意顺序 排列。 结果格式如下面的例子所示： 示例 1: 输入： Logs 表： +----+-----+ | id | num | +----+-----+ | 1 | 1 | | 2 | 1 | | 3 | 1 | | 4 | 2 | | 5 | 1 | | 6 | 2 | | 7 | 2 | +----+-----+ 输出： Result 表： +-----------------+ | ConsecutiveNums | +-----------------+ | 1 | +-----------------+ 解释：1 是唯一连续出现至少三次的数字。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: SQL自连接查询，查找连续出现的数字

算法步骤:
1. 使用自连接，连接条件为id连续
2. 检查三个连续行的num是否相同
3. 使用DISTINCT去重

关键点:
- 使用自连接查找连续记录
- SQL查询语句
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n^2) - 自连接的时间复杂度
空间复杂度: O(n) - 连接结果的空间
"""

# ============================================================================
# 代码实现
# ============================================================================

from leetcode_solutions.utils.solution import create_solution


def consecutive_numbers():
    """
    函数式接口 - 连续出现的数字（SQL查询）
    
    实现思路:
    使用自连接查找连续出现的数字。
    
    Returns:
        SQL查询语句字符串
        
    Example:
        >>> sql = consecutive_numbers()
        >>> # 执行SQL查询
    """
    sql = """
    SELECT DISTINCT l1.num AS ConsecutiveNums
    FROM Logs l1
    JOIN Logs l2 ON l1.id = l2.id - 1
    JOIN Logs l3 ON l1.id = l3.id - 2
    WHERE l1.num = l2.num AND l2.num = l3.num
    """
    return sql.strip()


# 自动生成Solution类（无需手动编写）
Solution = create_solution(consecutive_numbers)
