# -*- coding:utf-8 -*-
# ============================================================================
# 题目信息
# ============================================================================
"""
题号: 3335
标题: Minimum Operations to Write the Letter Y on a Grid
难度: medium
链接: https://leetcode.cn/problems/minimum-operations-to-write-the-letter-y-on-a-grid/
题目类型: 数组、哈希表、计数、矩阵
"""

# ============================================================================
# 问题描述
# ============================================================================
"""
3071. 在矩阵上写出字母 Y 所需的最少操作次数 - 给你一个下标从 0 开始、大小为 n x n 的矩阵 grid ，其中 n 为奇数，且 grid[r][c] 的值为 0 、1 或 2 。 如果一个单元格属于以下三条线中的任一一条，我们就认为它是字母 Y 的一部分： * 从左上角单元格开始到矩阵中心单元格结束的对角线。 * 从右上角单元格开始到矩阵中心单元格结束的对角线。 * 从中心单元格开始到矩阵底部边界结束的垂直线。 当且仅当满足以下全部条件时，可以判定矩阵上写有字母 Y ： * 属于 Y 的所有单元格的值相等。 * 不属于 Y 的所有单元格的值相等。 * 属于 Y 的单元格的值与不属于Y的单元格的值不同。 每次操作你可以将任意单元格的值改变为 0 、1 或 2 。返回在矩阵上写出字母 Y 所需的 最少 操作次数。 示例 1： [https://assets.leetcode.com/uploads/2024/01/22/y2.png] 输入：grid = [[1,2,2],[1,1,0],[0,1,0]] 输出：3 解释：将在矩阵上写出字母 Y 需要执行的操作用蓝色高亮显示。操作后，所有属于 Y 的单元格（加粗显示）的值都为 1 ，而不属于 Y 的单元格的值都为 0 。 可以证明，写出 Y 至少需要进行 3 次操作。 示例 2： [https://assets.leetcode.com/uploads/2024/01/22/y3.png] 输入：grid = [[0,1,0,1,0],[2,1,0,1,2],[2,2,2,0,1],[2,2,2,2,2],[2,1,2,2,2]] 输出：12 解释：将在矩阵上写出字母 Y 需要执行的操作用蓝色高亮显示。操作后，所有属于 Y 的单元格（加粗显示）的值都为 0 ，而不属于 Y 的单元格的值都为 2 。 可以证明，写出 Y 至少需要进行 12 次操作。 提示： * 3 <= n <= 49 * n == grid.length == grid[i].length * 0 <= grid[i][j] <= 2 * n 为奇数。
"""

# ============================================================================
# 实现思路
# ============================================================================
"""
核心思想: 计算每个单元格属于 Y 和不属于 Y 的情况下的操作次数，选择最小的操作次数。

算法步骤:
1. 初始化三个计数器，分别记录 Y 的单元格中 0、1、2 的数量。
2. 遍历矩阵，根据单元格是否属于 Y 更新计数器。
3. 计算每种情况下的操作次数，选择最小的操作次数。

关键点:
- 判断单元格是否属于 Y 的方法是通过其坐标。
- 通过计数器统计 Y 和非 Y 单元格的值，计算操作次数。
"""

# ============================================================================
# 复杂度分析
# ============================================================================
"""
时间复杂度: O(n^2)
空间复杂度: O(1)
"""

# ============================================================================
# 代码实现
# ============================================================================

from typing import List

def min_operations_to_write_y(grid: List[List[int]]) -> int:
    n = len(grid)
    center = n // 2
    y_counts = [0, 0, 0]
    non_y_counts = [0, 0, 0]

    for i in range(n):
        for j in range(n):
            if (i == j and i <= center) or (i + j == n - 1 and i < center) or (i > center and j == center):
                y_counts[grid[i][j]] += 1
            else:
                non_y_counts[grid[i][j]] += 1

    total_y = sum(y_counts)
    total_non_y = sum(non_y_counts)

    min_ops = float('inf')
    for y_val in range(3):
        for non_y_val in range(3):
            if y_val != non_y_val:
                ops = (total_y - y_counts[y_val]) + (total_non_y - non_y_counts[non_y_val])
                min_ops = min(min_ops, ops)

    return min_ops

Solution = create_solution(min_operations_to_write_y)